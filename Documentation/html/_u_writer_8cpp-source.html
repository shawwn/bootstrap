<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Bootstrap Engine: C:/Bootstrap/ProjectBX/Documentation/Code/Engine/Common/UWriter.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>C:/Bootstrap/ProjectBX/Documentation/Code/Engine/Common/UWriter.cpp</h1><a href="_u_writer_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//----------------------------------------------------------</span>
<a name="l00006"></a>00006 <span class="comment"></span><span class="comment">//----------------------------------------------------------</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include "<a class="code" href="common__afx_8h.html">common_afx.h</a>"</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include "<a class="code" href="_u_writer_8h.html">UWriter.h</a>"</span>
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="comment">//**********************************************************</span>
<a name="l00012"></a>00012 <span class="comment"></span><span class="comment">//**********************************************************</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="comment">//==========================================================</span>
<a name="l00016"></a>00016 <span class="comment"></span><span class="comment">//==========================================================</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="comment">//----------------------------------------------------------</span>
<a name="l00019"></a><a class="code" href="class_u_writer.html#84ac4e433ef43762c38e973b50b2a900">00019</a> <a class="code" href="class_u_writer.html#84ac4e433ef43762c38e973b50b2a900" title="class UWriter">UWriter::UWriter</a>( <span class="keywordtype">void</span> *<a class="code" href="glext_8h.html#c4fdb15bdbcd63430bab668b5419ed9f">buffer</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="glext_8h.html#3d1e3edfcf61ca2d831883e1afbad89e">size</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> growSize, <span class="keywordtype">bool</span> own )
<a name="l00020"></a>00020 : _size( size )
<a name="l00021"></a>00021 , _buffer( buffer )
<a name="l00022"></a>00022 , _growSize( growSize )
<a name="l00023"></a>00023 , _offset( 0 )
<a name="l00024"></a>00024 , _ownPtr( own )
<a name="l00025"></a>00025 {
<a name="l00026"></a>00026         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( growSize != 0 );
<a name="l00027"></a>00027 }
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="comment">//----------------------------------------------------------</span>
<a name="l00030"></a><a class="code" href="class_u_writer.html#676a90967b367e7787dfc1441a0f43cc">00030</a> <a class="code" href="class_u_writer.html#84ac4e433ef43762c38e973b50b2a900" title="class UWriter">UWriter::UWriter</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> initSize, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> growSize )
<a name="l00031"></a>00031 : _size( initSize )
<a name="l00032"></a>00032 , _buffer( new char[ initSize ] )
<a name="l00033"></a>00033 , _growSize( growSize )
<a name="l00034"></a>00034 , _offset( 0 )
<a name="l00035"></a>00035 , _ownPtr( true )
<a name="l00036"></a>00036 {
<a name="l00037"></a>00037         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( growSize != 0 );      
<a name="l00038"></a>00038 }
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="comment">//----------------------------------------------------------</span>
<a name="l00041"></a><a class="code" href="class_u_writer.html#8121227135a3e5565f9fb01d3864b112">00041</a> <a class="code" href="class_u_writer.html#8121227135a3e5565f9fb01d3864b112">UWriter::~UWriter</a>()
<a name="l00042"></a>00042 {
<a name="l00043"></a>00043         <span class="keywordflow">if</span> ( _ownPtr )
<a name="l00044"></a>00044                 <span class="keyword">delete</span>[] ( <span class="keywordtype">char</span>* )_buffer;
<a name="l00045"></a>00045 }
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="comment">//==========================================================</span>
<a name="l00050"></a>00050 <span class="comment"></span><span class="comment">//==========================================================</span>
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="comment">//----------------------------------------------------------</span>
<a name="l00053"></a>00053 <span class="keywordtype">void</span>
<a name="l00054"></a><a class="code" href="class_u_writer.html#bbe55ee0c4a3b202b365da202899d410">00054</a> <a class="code" href="class_u_writer.html#bbe55ee0c4a3b202b365da202899d410" title="public methods">UWriter::WriteString</a>( <span class="keyword">const</span> <a class="code" href="common__afx_8h.html#816fa58fd77499b0edb2c69ebe803d5c" title="include BootstrapFS.">tstring</a>&amp; str, <span class="keywordtype">bool</span> writeNullTerm )
<a name="l00055"></a>00055 {
<a name="l00057"></a>00057         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="glext_8h.html#2ba89f9e8d669bfad57028ce780865cd">len</a> = ( <span class="keywordtype">unsigned</span> <a class="code" href="_g_l_aux_8h.html#b832c174e145540d491b0830fc05dbb1">int</a> )str.length() + ( writeNullTerm ? 1 : 0 );
<a name="l00058"></a>00058         EnsureMemSize( len );
<a name="l00059"></a>00059         <a class="code" href="common__afx_8cpp.html#b4b15928b71967d4c4eb8c12c3108643">MemCopy</a>( ( ( <span class="keywordtype">char</span> * )_buffer ) + _offset, str.c_str(), len );
<a name="l00060"></a>00060         _offset += len;
<a name="l00061"></a>00061 }
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 <span class="comment">//----------------------------------------------------------</span>
<a name="l00064"></a>00064 <span class="keywordtype">void</span>
<a name="l00065"></a><a class="code" href="class_u_writer.html#753241171303a3cc3257e323846f2d3f">00065</a> <a class="code" href="class_u_writer.html#bbe55ee0c4a3b202b365da202899d410" title="public methods">UWriter::WriteString</a>( <span class="keyword">const</span> <span class="keywordtype">char</span>* str, <span class="keywordtype">bool</span> writeNullTerm )
<a name="l00066"></a>00066 {
<a name="l00068"></a>00068         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="glext_8h.html#2ba89f9e8d669bfad57028ce780865cd">len</a> = ( <span class="keywordtype">unsigned</span> <a class="code" href="_g_l_aux_8h.html#b832c174e145540d491b0830fc05dbb1">int</a> )strlen( str ) + ( writeNullTerm ? 1 : 0 );
<a name="l00069"></a>00069         EnsureMemSize( len );
<a name="l00070"></a>00070         <a class="code" href="common__afx_8cpp.html#b4b15928b71967d4c4eb8c12c3108643">MemCopy</a>( ( ( <span class="keywordtype">char</span> * )_buffer ) + _offset, str, len );
<a name="l00071"></a>00071         _offset += len;
<a name="l00072"></a>00072 }
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="comment">//----------------------------------------------------------</span>
<a name="l00075"></a>00075 <span class="keywordtype">void</span>
<a name="l00076"></a><a class="code" href="class_u_writer.html#3c706400f5fe0fe26cd8ebfe5a55d13a">00076</a> <a class="code" href="class_u_writer.html#3c706400f5fe0fe26cd8ebfe5a55d13a">UWriter::WriteChar</a>( <span class="keywordtype">char</span> ch )
<a name="l00077"></a>00077 {
<a name="l00078"></a>00078         EnsureMemSize( <span class="keyword">sizeof</span>( <span class="keywordtype">char</span> ) );
<a name="l00079"></a>00079         *( ( ( <span class="keywordtype">char</span> * )_buffer ) + _offset ) = ch;
<a name="l00080"></a>00080         ++_offset;
<a name="l00081"></a>00081 }
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 <span class="comment">//----------------------------------------------------------</span>
<a name="l00084"></a>00084 <span class="keywordtype">void</span>
<a name="l00085"></a><a class="code" href="class_u_writer.html#ad53e1a9063eec9545834eb288fe0767">00085</a> <a class="code" href="class_u_writer.html#ad53e1a9063eec9545834eb288fe0767">UWriter::WriteShort</a>( <span class="keywordtype">short</span> <a class="code" href="glext_8h.html#dfdba28282fbf886223676912be34ab4">v</a> )
<a name="l00086"></a>00086 {
<a name="l00087"></a>00087         EnsureMemSize( <span class="keyword">sizeof</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ) );
<a name="l00088"></a>00088         *( ( <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>* )( ( ( <span class="keywordtype">char</span>* )_buffer ) + _offset ) ) = v;
<a name="l00089"></a>00089         _offset += <span class="keyword">sizeof</span>( <span class="keywordtype">unsigned</span> short );    
<a name="l00090"></a>00090 }
<a name="l00091"></a>00091 
<a name="l00092"></a>00092 <span class="comment">//----------------------------------------------------------</span>
<a name="l00093"></a>00093 <span class="keywordtype">void</span>
<a name="l00094"></a><a class="code" href="class_u_writer.html#2012d798142a97cacf03227395c2e24c">00094</a> <a class="code" href="class_u_writer.html#2012d798142a97cacf03227395c2e24c">UWriter::WriteInt</a>( <span class="keywordtype">int</span> i )
<a name="l00095"></a>00095 {
<a name="l00096"></a>00096         EnsureMemSize( <span class="keyword">sizeof</span>( <span class="keywordtype">int</span> ) );
<a name="l00097"></a>00097         *( ( <span class="keywordtype">int</span>* )( ( ( <span class="keywordtype">char</span>* )_buffer ) + _offset ) ) = i;
<a name="l00098"></a>00098         _offset += <span class="keyword">sizeof</span>( <a class="code" href="_g_l_aux_8h.html#b832c174e145540d491b0830fc05dbb1">int</a> );
<a name="l00099"></a>00099 }
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 <span class="comment">//----------------------------------------------------------</span>
<a name="l00102"></a>00102 <span class="keywordtype">void</span>
<a name="l00103"></a><a class="code" href="class_u_writer.html#a1f6d44d3988a40cc188ab237c5edc0a">00103</a> <a class="code" href="class_u_writer.html#a1f6d44d3988a40cc188ab237c5edc0a">UWriter::WriteUInt</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i )
<a name="l00104"></a>00104 {
<a name="l00105"></a>00105         EnsureMemSize( <span class="keyword">sizeof</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ) );
<a name="l00106"></a>00106         *( ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> * )( ( ( <span class="keywordtype">char</span> * )_buffer ) + _offset ) ) = i;
<a name="l00107"></a>00107         _offset += <span class="keyword">sizeof</span>( <span class="keywordtype">unsigned</span> int );
<a name="l00108"></a>00108 }
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 <span class="comment">//----------------------------------------------------------</span>
<a name="l00111"></a>00111 <span class="keywordtype">void</span>
<a name="l00112"></a><a class="code" href="class_u_writer.html#b70c7cb62e406390fb68ddbb22ad25e7">00112</a> <a class="code" href="class_u_writer.html#b70c7cb62e406390fb68ddbb22ad25e7">UWriter::WriteFloat</a>( <span class="keywordtype">float</span> f )
<a name="l00113"></a>00113 {
<a name="l00114"></a>00114         EnsureMemSize( <span class="keyword">sizeof</span>( <span class="keywordtype">float</span> ) );
<a name="l00115"></a>00115         *( ( <span class="keywordtype">float</span> * )( ( ( <span class="keywordtype">char</span> * )_buffer ) + _offset ) ) = f;
<a name="l00116"></a>00116         _offset += <span class="keyword">sizeof</span>( float );
<a name="l00117"></a>00117 }
<a name="l00118"></a>00118 
<a name="l00119"></a>00119 <span class="comment">//----------------------------------------------------------</span>
<a name="l00120"></a>00120 <span class="keywordtype">void</span>
<a name="l00121"></a><a class="code" href="class_u_writer.html#db6161ee8139f7215bddb0c0e9f7f427">00121</a> <a class="code" href="class_u_writer.html#db6161ee8139f7215bddb0c0e9f7f427">UWriter::WriteBytes</a>( <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="glext_8h.html#c4fdb15bdbcd63430bab668b5419ed9f">buffer</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="_g_l_8h.html#10b284d589000663becfbc6867a3a9f7">count</a> )
<a name="l00122"></a>00122 {
<a name="l00123"></a>00123         EnsureMemSize( count );
<a name="l00124"></a>00124         <a class="code" href="common__afx_8cpp.html#b4b15928b71967d4c4eb8c12c3108643">MemCopy</a>( ( ( <span class="keywordtype">char</span> * )_buffer ) + _offset, buffer, count );
<a name="l00125"></a>00125         _offset += count;
<a name="l00126"></a>00126 }
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 <span class="comment">//==========================================================</span>
<a name="l00131"></a>00131 <span class="comment"></span><span class="comment">//==========================================================</span>
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 <span class="comment">//----------------------------------------------------------</span>
<a name="l00134"></a>00134 <span class="keywordtype">void</span>
<a name="l00135"></a>00135 UWriter::EnsureMemSize( <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> bytesToWrite )
<a name="l00136"></a>00136 {
<a name="l00137"></a>00137         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> neededSize = _offset + bytesToWrite;
<a name="l00138"></a>00138         <span class="keywordflow">if</span> ( neededSize &gt; _size )
<a name="l00139"></a>00139         {
<a name="l00142"></a>00142                 <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( _ownPtr );
<a name="l00143"></a>00143 
<a name="l00145"></a>00145                 <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> newSize = neededSize + ( _growSize - ( neededSize % _growSize ) );
<a name="l00146"></a>00146                 <span class="keywordtype">void</span> *newMem = <span class="keyword">new</span> <span class="keywordtype">char</span>[ newSize ];
<a name="l00147"></a>00147 
<a name="l00149"></a>00149                 <a class="code" href="common__afx_8cpp.html#b4b15928b71967d4c4eb8c12c3108643">MemCopy</a>( newMem, _buffer, <a class="code" href="class_u_writer.html#362bb4a3c111c793e22927a6b26afe0c">GetBytesWritten</a>() );
<a name="l00150"></a>00150                 <span class="keyword">delete</span>[] ( <span class="keywordtype">char</span>* )_buffer;
<a name="l00151"></a>00151 
<a name="l00153"></a>00153                 _buffer = newMem;
<a name="l00154"></a>00154                 _size = newSize;
<a name="l00155"></a>00155         }
<a name="l00156"></a>00156 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Feb 13 17:19:50 2009 for Bootstrap Engine by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
