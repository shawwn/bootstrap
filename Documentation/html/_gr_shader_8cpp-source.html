<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Bootstrap Engine: C:/Bootstrap/ProjectBX/Documentation/Code/Engine/Graphics/GrShader.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>C:/Bootstrap/ProjectBX/Documentation/Code/Engine/Graphics/GrShader.cpp</h1><a href="_gr_shader_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//----------------------------------------------------------</span>
<a name="l00006"></a>00006 <span class="comment"></span><span class="comment">//----------------------------------------------------------</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include "<a class="code" href="graphics__afx_8h.html">graphics_afx.h</a>"</span>
<a name="l00008"></a>00008 
<a name="l00010"></a>00010 <span class="preprocessor">#include "<a class="code" href="_gr_shader_8h.html">GrShader.h</a>"</span>
<a name="l00011"></a>00011 
<a name="l00013"></a>00013 <span class="preprocessor">#include "<a class="code" href="_gr_shader_mgr_8h.html">GrShaderMgr.h</a>"</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include "<a class="code" href="_g_l_subsys_8h.html">GLSubsys.h</a>"</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include "<a class="code" href="_gr_util_8h.html">GrUtil.h</a>"</span>
<a name="l00016"></a>00016 
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;stdarg.h&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00020"></a>00020 
<a name="l00021"></a><a class="code" href="_gr_shader_8cpp.html#e7e715e018c2f777152e96657ef942b3">00021</a> <span class="preprocessor">#define GLSL_VERSION_STRINGIZE2( x )    #x</span>
<a name="l00022"></a><a class="code" href="_gr_shader_8cpp.html#37e8e6b43cbf1bf3b7736a732b71db8a">00022</a> <span class="preprocessor"></span><span class="preprocessor">#define GLSL_VERSION_STRINGIZE( x )             GLSL_VERSION_STRINGIZE2( x )</span>
<a name="l00023"></a><a class="code" href="_gr_shader_8cpp.html#31824ada48c520a48ebb8b6475b742a1">00023</a> <span class="preprocessor"></span><span class="preprocessor">#define GLSL_VERSION_STRING                             "#version "GLSL_VERSION_STRINGIZE( GR_GLSL_SHADER_VERSION )"\n"</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span>
<a name="l00025"></a>00025 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> kErrorShaderVS[] =
<a name="l00026"></a>00026 <span class="stringliteral">"attribute vec3 a_Position;\n"</span>
<a name="l00027"></a>00027 <span class="stringliteral">"uniform mat4 u_ModelViewProjectionMatrix;\n"</span>
<a name="l00028"></a>00028 <span class="stringliteral">"void main()\n"</span>
<a name="l00029"></a>00029 <span class="stringliteral">"{\n"</span>
<a name="l00030"></a>00030 <span class="stringliteral">"\tgl_Position = u_ModelViewProjectionMatrix * vec4( a_Position.xyz, 1.0 );\n"</span>
<a name="l00031"></a>00031 <span class="stringliteral">"}\n"</span>
<a name="l00032"></a>00032 ;
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> kErrorShaderFS[] =
<a name="l00035"></a>00035 <span class="stringliteral">"void main()\n"</span>
<a name="l00036"></a>00036 <span class="stringliteral">"{\n"</span>
<a name="l00037"></a>00037 <span class="stringliteral">"\tgl_FragColor = vec4( 1.0f, 0.0f, 0.0f, 1.0f );\n"</span>
<a name="l00038"></a>00038 <span class="stringliteral">"}\n"</span>
<a name="l00039"></a>00039 ;
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="comment">//**********************************************************</span>
<a name="l00043"></a>00043 <span class="comment"></span><span class="comment">//**********************************************************</span>
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="comment">//==========================================================</span>
<a name="l00047"></a>00047 <span class="comment"></span><span class="comment">//==========================================================</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="comment">//----------------------------------------------------------</span>
<a name="l00050"></a><a class="code" href="class_gr_shader.html#bdf1c0db4547dc0f83a672954a110ee3">00050</a> <a class="code" href="class_gr_shader.html#bdf1c0db4547dc0f83a672954a110ee3" title="class GrShader">GrShader::GrShader</a>( <span class="keyword">const</span> <a class="code" href="class_u_path.html" title="Purpose: To provide a clean way to represent paths strings.">UPath</a>&amp; <a class="code" href="glext_8h.html#f7477b8725fcf509c9623f64b9d09164">name</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* vSource, <span class="keyword">const</span> <span class="keywordtype">char</span>* fSource )
<a name="l00051"></a>00051 : _name( name )
<a name="l00052"></a>00052 , _vSource( vSource )
<a name="l00053"></a>00053 , _fSource( fSource )
<a name="l00054"></a>00054 , _glShader( 0 )
<a name="l00055"></a>00055 , _quality( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033bfb5dc4b6ee1d1f5d0b224995dd28093">EGQ_COUNT</a> )
<a name="l00056"></a>00056 {
<a name="l00057"></a>00057         <a class="code" href="common__afx_8h.html#9f04579206286b6dc8c9708063450144" title="memory functions.">MemSet</a>( _glShaders, 0, <span class="keyword">sizeof</span>( _glShaders ) );
<a name="l00058"></a>00058         <a class="code" href="common__afx_8h.html#9f04579206286b6dc8c9708063450144" title="memory functions.">MemSet</a>( _glVertShaders, 0, <span class="keyword">sizeof</span>( _glVertShaders ) );
<a name="l00059"></a>00059         <a class="code" href="common__afx_8h.html#9f04579206286b6dc8c9708063450144" title="memory functions.">MemSet</a>( _glFragShaders, 0, <span class="keyword">sizeof</span>( _glFragShaders ) );
<a name="l00060"></a>00060         <a class="code" href="common__afx_8h.html#9f04579206286b6dc8c9708063450144" title="memory functions.">MemSet</a>( _needValidate, 1, <span class="keyword">sizeof</span>( _needValidate ) );
<a name="l00061"></a>00061         <a class="code" href="common__afx_8h.html#9f04579206286b6dc8c9708063450144" title="memory functions.">MemSet</a>( _samplersUsed, 0, <span class="keyword">sizeof</span>( _samplersUsed ) );
<a name="l00062"></a>00062         Build();
<a name="l00063"></a>00063 }
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="comment">//----------------------------------------------------------</span>
<a name="l00066"></a><a class="code" href="class_gr_shader.html#aa73966b218a209656f7e2c594d290ce">00066</a> <a class="code" href="class_gr_shader.html#aa73966b218a209656f7e2c594d290ce">GrShader::~GrShader</a>()
<a name="l00067"></a>00067 {
<a name="l00068"></a>00068         Clean();
<a name="l00069"></a>00069 }
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 
<a name="l00072"></a>00072 <span class="comment">//==========================================================</span>
<a name="l00074"></a>00074 <span class="comment"></span><span class="comment">//==========================================================</span>
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 <span class="comment">//----------------------------------------------------------</span>
<a name="l00077"></a>00077 <span class="keywordtype">bool</span>
<a name="l00078"></a><a class="code" href="class_gr_shader.html#f9ce91e69a32ecd1ec6aa457c5fff942">00078</a> <a class="code" href="class_gr_shader.html#f9ce91e69a32ecd1ec6aa457c5fff942" title="public methods">GrShader::Rebuild</a>( <span class="keyword">const</span> <a class="code" href="common__afx_8h.html#816fa58fd77499b0edb2c69ebe803d5c" title="include BootstrapFS.">tstring</a>&amp; vSource, <span class="keyword">const</span> <a class="code" href="common__afx_8h.html#816fa58fd77499b0edb2c69ebe803d5c" title="include BootstrapFS.">tstring</a>&amp; fSource )
<a name="l00079"></a>00079 {
<a name="l00081"></a>00081         _vSource = vSource;
<a name="l00082"></a>00082         _fSource = fSource;
<a name="l00083"></a>00083         Build();
<a name="l00084"></a>00084 
<a name="l00086"></a>00086         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033bfb5dc4b6ee1d1f5d0b224995dd28093">EGQ_COUNT</a>; ++i )
<a name="l00087"></a>00087         {
<a name="l00089"></a>00089                 <span class="keywordflow">if</span> ( !_glShaders[ i ] )
<a name="l00090"></a>00090                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00091"></a>00091         }
<a name="l00092"></a>00092 
<a name="l00094"></a>00094         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00095"></a>00095 }
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 <span class="comment">//----------------------------------------------------------</span>
<a name="l00098"></a>00098 <span class="keywordtype">bool</span>
<a name="l00099"></a><a class="code" href="class_gr_shader.html#e40cd62323e0186bd30977b00617516e">00099</a> <a class="code" href="class_gr_shader.html#e40cd62323e0186bd30977b00617516e" title="returns true or false if a sampler is used by the shader.">GrShader::IsGLSamplerUsed</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> texUnit )
<a name="l00100"></a>00100 {
<a name="l00102"></a>00102         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( texUnit &lt; 16 );
<a name="l00103"></a>00103 
<a name="l00105"></a>00105         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033bfb5dc4b6ee1d1f5d0b224995dd28093">EGQ_COUNT</a>; ++i )
<a name="l00106"></a>00106                 <span class="keywordflow">if</span> ( <a class="code" href="class_gr_shader.html#e40cd62323e0186bd30977b00617516e" title="returns true or false if a sampler is used by the shader.">IsGLSamplerUsed</a>( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, texUnit ) )
<a name="l00107"></a>00107                         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00108"></a>00108 
<a name="l00110"></a>00110         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00111"></a>00111 }
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 <span class="comment">//----------------------------------------------------------</span>
<a name="l00114"></a>00114 <span class="keywordtype">bool</span>
<a name="l00115"></a><a class="code" href="class_gr_shader.html#64b1416ca1fd91ff9da4a37bbbf5bb0e">00115</a> <a class="code" href="class_gr_shader.html#e40cd62323e0186bd30977b00617516e" title="returns true or false if a sampler is used by the shader.">GrShader::IsGLSamplerUsed</a>( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> quality, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> texUnit )
<a name="l00116"></a>00116 {
<a name="l00118"></a>00118         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( texUnit &lt; 16 );
<a name="l00119"></a>00119 
<a name="l00121"></a>00121         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bit = ( 1 &lt;&lt; texUnit );
<a name="l00122"></a>00122         <span class="keywordflow">return</span> ( _samplersUsed[ quality ] &amp; bit ) != 0;
<a name="l00123"></a>00123 }
<a name="l00124"></a>00124 
<a name="l00125"></a>00125 <span class="comment">//----------------------------------------------------------</span>
<a name="l00126"></a>00126 <span class="keywordtype">bool</span>
<a name="l00127"></a><a class="code" href="class_gr_shader.html#a482dc096d94ac3e751bce76dcae167b">00127</a> <a class="code" href="class_gr_shader.html#a482dc096d94ac3e751bce76dcae167b">GrShader::BindUserSampler</a>( <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="glext_8h.html#f7477b8725fcf509c9623f64b9d09164">name</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> texUnit )
<a name="l00128"></a>00128 {
<a name="l00129"></a>00129         <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00130"></a>00130         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( texUnit &lt; 16 );
<a name="l00131"></a>00131 
<a name="l00132"></a>00132         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033bfb5dc4b6ee1d1f5d0b224995dd28093">EGQ_COUNT</a>; ++i )
<a name="l00133"></a>00133                 SetSamplerUsed( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, texUnit );
<a name="l00134"></a>00134 
<a name="l00136"></a>00136         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="glext_8h.html#d585a1393cfa368fa9dc3d8ebff640d5">s</a> = 0;
<a name="l00137"></a>00137         <span class="keywordflow">for</span> ( ; s &lt; <a class="code" href="class_gr_shader.html#cbaa822de5def45617ccfb833996864e">kMaxUserSamplers</a>; ++s )
<a name="l00138"></a>00138         {
<a name="l00140"></a>00140                 <span class="keywordflow">if</span> ( strcmp( _userSamplers[ s ].name.c_str(), name ) == 0 )
<a name="l00141"></a>00141                 {
<a name="l00144"></a>00144                         _userSamplers[ s ].texUnit = texUnit;
<a name="l00145"></a>00145                         <span class="keywordflow">break</span>;
<a name="l00146"></a>00146                 }
<a name="l00147"></a>00147         }
<a name="l00148"></a>00148 
<a name="l00150"></a>00150         <span class="keywordflow">if</span> ( s == kMaxUserSamplers )
<a name="l00151"></a>00151         {
<a name="l00152"></a>00152                 <span class="keywordflow">for</span> ( s = 0; s &lt; kMaxUserSamplers; ++s )
<a name="l00153"></a>00153                 {
<a name="l00154"></a>00154                         <span class="keywordflow">if</span> ( _userSamplers[ s ].name.length() == 0 )
<a name="l00155"></a>00155                         {
<a name="l00157"></a>00157                                 _userSamplers[ s ].name = name;
<a name="l00158"></a>00158                                 _userSamplers[ s ].texUnit = texUnit;
<a name="l00159"></a>00159                                 <span class="keywordflow">break</span>;
<a name="l00160"></a>00160                         }
<a name="l00161"></a>00161                 }
<a name="l00162"></a>00162         }
<a name="l00163"></a>00163 
<a name="l00166"></a>00166         <span class="keywordflow">if</span> ( s == kMaxUserSamplers )
<a name="l00167"></a>00167                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00168"></a>00168 
<a name="l00169"></a>00169         SetUserSamplerUniform( name, texUnit );
<a name="l00170"></a>00170 
<a name="l00172"></a>00172         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00173"></a>00173 }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="comment">//----------------------------------------------------------</span>
<a name="l00176"></a>00176 <span class="keywordtype">void</span>
<a name="l00177"></a><a class="code" href="class_gr_shader.html#420e8f1956844878d2a8aeb09f0ab888">00177</a> <a class="code" href="class_gr_shader.html#420e8f1956844878d2a8aeb09f0ab888">GrShader::Validate</a>()
<a name="l00178"></a>00178 {
<a name="l00179"></a>00179         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033bfb5dc4b6ee1d1f5d0b224995dd28093">EGQ_COUNT</a>; ++i )
<a name="l00180"></a>00180                 <a class="code" href="class_gr_shader.html#420e8f1956844878d2a8aeb09f0ab888">Validate</a>( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i );
<a name="l00181"></a>00181 }
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 <span class="comment">//----------------------------------------------------------</span>
<a name="l00184"></a>00184 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>
<a name="l00185"></a><a class="code" href="class_gr_shader.html#94d6c2ccfc6e5b98ed4fee018308b5cb">00185</a> <a class="code" href="class_gr_shader.html#94d6c2ccfc6e5b98ed4fee018308b5cb" title="returns the index of the attribute specified.">GrShader::GetAttribIndex</a>( <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="glext_8h.html#f7477b8725fcf509c9623f64b9d09164">name</a> )
<a name="l00186"></a>00186 {
<a name="l00187"></a>00187         <span class="keywordflow">return</span> <a class="code" href="_g_l_subsys_8cpp.html#9c34e969f703bba334ff1518c3adcff7">bglGetAttribLocation</a>( _glShader, name );
<a name="l00188"></a>00188 }
<a name="l00189"></a>00189 
<a name="l00190"></a>00190 <span class="comment">//----------------------------------------------------------</span>
<a name="l00191"></a>00191 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>
<a name="l00192"></a><a class="code" href="class_gr_shader.html#6aaf2b4a333467d7c254dd2f4d862a83">00192</a> <a class="code" href="class_gr_shader.html#94d6c2ccfc6e5b98ed4fee018308b5cb" title="returns the index of the attribute specified.">GrShader::GetAttribIndex</a>( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> quality, <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="glext_8h.html#f7477b8725fcf509c9623f64b9d09164">name</a> )
<a name="l00193"></a>00193 {
<a name="l00194"></a>00194         <span class="keywordflow">return</span> <a class="code" href="_g_l_subsys_8cpp.html#9c34e969f703bba334ff1518c3adcff7">bglGetAttribLocation</a>( _glShaders[ quality ], name );
<a name="l00195"></a>00195 }
<a name="l00196"></a>00196 
<a name="l00197"></a>00197 <span class="comment">//----------------------------------------------------------</span>
<a name="l00198"></a>00198 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>
<a name="l00199"></a><a class="code" href="class_gr_shader.html#c7df07b490ebee35fc316ccdccaf0a91">00199</a> <a class="code" href="class_gr_shader.html#c7df07b490ebee35fc316ccdccaf0a91" title="user params.">GrShader::GenUserParamHandle</a>()
<a name="l00200"></a>00200 {
<a name="l00202"></a>00202         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = <a class="code" href="class_gr_shader.html#32d823afd380bcdf283ed2e667cf66cb">kMaxUserParams</a>-1; i &gt;= 0; --i )
<a name="l00203"></a>00203         {
<a name="l00204"></a>00204                 <span class="keywordflow">if</span> ( _userParams[ i ].<a class="code" href="glext_8h.html#f7477b8725fcf509c9623f64b9d09164">name</a>.length() == 0 )
<a name="l00205"></a>00205                         <span class="keywordflow">return</span> i;
<a name="l00206"></a>00206         }
<a name="l00207"></a>00207 
<a name="l00209"></a>00209         <span class="keywordflow">return</span> ~0;
<a name="l00210"></a>00210 }
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 <span class="comment">//----------------------------------------------------------</span>
<a name="l00213"></a>00213 <span class="keywordtype">bool</span>
<a name="l00214"></a><a class="code" href="class_gr_shader.html#e95cb134961fe00f4c4cd59e52d2d136">00214</a> <a class="code" href="class_gr_shader.html#e95cb134961fe00f4c4cd59e52d2d136">GrShader::InitUserParam</a>( <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="glext_8h.html#f7477b8725fcf509c9623f64b9d09164">name</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> handle )
<a name="l00215"></a>00215 {
<a name="l00216"></a>00216         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( handle &lt; <a class="code" href="class_gr_shader.html#32d823afd380bcdf283ed2e667cf66cb">kMaxUserParams</a> );
<a name="l00217"></a>00217         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( strlen( name ) &gt; 0 );
<a name="l00218"></a>00218 
<a name="l00220"></a>00220         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_gr_shader.html#32d823afd380bcdf283ed2e667cf66cb">kMaxUserParams</a>; ++i )
<a name="l00221"></a>00221         {
<a name="l00223"></a>00223                 <span class="keywordflow">if</span> ( strcmp( _userParams[ i ].name.c_str(), name ) == 0 )
<a name="l00224"></a>00224                 {
<a name="l00225"></a>00225                         <a class="code" href="common__afx_8cpp.html#f1a1e0f08b49000974368246e5b97f84" title="debug output/console output function.">PrintF</a>( <span class="stringliteral">"Warning: parameter %s in shader %s has already been bound to a handle; ignoring initialize call.\n"</span>,
<a name="l00226"></a>00226                                 name, _name.<a class="code" href="class_u_path.html#970648bc09145c6da1712022d84ad3b7" title="returns the path string.">GetPathString</a>().c_str() );
<a name="l00227"></a>00227                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00228"></a>00228                 }
<a name="l00229"></a>00229         }
<a name="l00230"></a>00230 
<a name="l00231"></a>00231         <span class="keywordflow">if</span> ( _userParams[ handle ].name.length() &gt; 0 )
<a name="l00232"></a>00232         {
<a name="l00233"></a>00233                 <a class="code" href="common__afx_8cpp.html#f1a1e0f08b49000974368246e5b97f84" title="debug output/console output function.">PrintF</a>( <span class="stringliteral">"Warning: Attempt to bind parameter %s in shader %s to a handle already being used by parameter %s; ignoring initialize call.\n"</span>,
<a name="l00234"></a>00234                         name, _name.<a class="code" href="class_u_path.html#970648bc09145c6da1712022d84ad3b7" title="returns the path string.">GetPathString</a>().c_str(), _userParams[ handle ].name.c_str() );
<a name="l00235"></a>00235                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00236"></a>00236         }
<a name="l00237"></a>00237 
<a name="l00239"></a>00239         SUserParam* <a class="code" href="glext_8h.html#c7c896d55e93a6cf7ff8524005b4e7b4">param</a> = _userParams + handle;
<a name="l00240"></a>00240         param-&gt;name = name;
<a name="l00241"></a>00241 
<a name="l00242"></a>00242         <span class="keywordtype">bool</span> found = GetUserParamInfo( param );
<a name="l00243"></a>00243         <span class="keywordflow">if</span> ( !found )
<a name="l00244"></a>00244                 <a class="code" href="common__afx_8cpp.html#f1a1e0f08b49000974368246e5b97f84" title="debug output/console output function.">PrintF</a>( <span class="stringliteral">"Warning: Parameter %s in shader %s was not found.\n"</span>, name, _name.<a class="code" href="class_u_path.html#970648bc09145c6da1712022d84ad3b7" title="returns the path string.">GetPathString</a>().c_str() );
<a name="l00245"></a>00245 
<a name="l00247"></a>00247         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00248"></a>00248 }
<a name="l00249"></a>00249 
<a name="l00250"></a>00250 <span class="comment">//----------------------------------------------------------</span>
<a name="l00251"></a>00251 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>
<a name="l00252"></a><a class="code" href="class_gr_shader.html#43d8fd833e55e423dc8ac3d49ccc36ba">00252</a> <a class="code" href="class_gr_shader.html#43d8fd833e55e423dc8ac3d49ccc36ba">GrShader::GetUserParamHandle</a>( <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="glext_8h.html#f7477b8725fcf509c9623f64b9d09164">name</a> )
<a name="l00253"></a>00253 {
<a name="l00255"></a>00255         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_gr_shader.html#32d823afd380bcdf283ed2e667cf66cb">kMaxUserParams</a>; ++i )
<a name="l00256"></a>00256         {
<a name="l00258"></a>00258                 <span class="keywordflow">if</span> ( strcmp( _userParams[ i ].name.c_str(), name ) == 0 )
<a name="l00259"></a>00259                         <span class="keywordflow">return</span> i;
<a name="l00260"></a>00260         }
<a name="l00261"></a>00261 
<a name="l00263"></a>00263         <span class="keywordflow">return</span> ~0;
<a name="l00264"></a>00264 }
<a name="l00265"></a>00265 
<a name="l00266"></a>00266 <span class="comment">//----------------------------------------------------------</span>
<a name="l00267"></a>00267 <span class="keywordtype">void</span>
<a name="l00268"></a><a class="code" href="class_gr_shader.html#8521f7e58ccb0116d07e2c501ae06f87">00268</a> <a class="code" href="class_gr_shader.html#8521f7e58ccb0116d07e2c501ae06f87">GrShader::SetUserParam4fv</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> handle, <span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="_g_l_8h.html#89ce72163394e6aef63b551a8806e93f">data</a> )
<a name="l00269"></a>00269 {
<a name="l00271"></a>00271         <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00272"></a>00272 
<a name="l00274"></a>00274         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( handle &lt; <a class="code" href="class_gr_shader.html#32d823afd380bcdf283ed2e667cf66cb">kMaxUserParams</a> );
<a name="l00275"></a>00275         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( <a class="code" href="_gr_util_8cpp.html#cf8fae2ee0807b48ac9c5bdb8ae47583">GrGetShader</a>() == _glShader );
<a name="l00276"></a>00276         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( strlen( _userParams[ handle ].<a class="code" href="glext_8h.html#f7477b8725fcf509c9623f64b9d09164">name</a>.c_str() ) &gt; 0 );   
<a name="l00277"></a>00277 
<a name="l00279"></a>00279         <span class="keywordflow">if</span> ( _userParams[ handle ].UniformXfvARB[ _quality ] == 0 )
<a name="l00280"></a>00280                 <span class="keywordflow">return</span>;
<a name="l00281"></a>00281 
<a name="l00283"></a>00283         _userParams[ handle ].UniformXfvARB[ _quality ]( _userParams[ handle ].handles[ _quality ], 1, data );
<a name="l00284"></a>00284 
<a name="l00287"></a>00287         <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00288"></a>00288 }
<a name="l00289"></a>00289 
<a name="l00290"></a>00290 <span class="comment">//----------------------------------------------------------</span>
<a name="l00291"></a>00291 <span class="keywordtype">void</span>
<a name="l00292"></a><a class="code" href="class_gr_shader.html#151b6e0ff7c3e9fa37c5bc2498e752fe">00292</a> <a class="code" href="class_gr_shader.html#151b6e0ff7c3e9fa37c5bc2498e752fe" title="renderer driven params.">GrShader::SetEngineParam4fv</a>( <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba" title="engine driven parameters.">EPARAM</a> <a class="code" href="glext_8h.html#c7c896d55e93a6cf7ff8524005b4e7b4">param</a>, <span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="_g_l_8h.html#89ce72163394e6aef63b551a8806e93f">data</a> )
<a name="l00293"></a>00293 {
<a name="l00295"></a>00295         <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00296"></a>00296 
<a name="l00298"></a>00298         <span class="keywordflow">if</span> ( _engineParamHandles[ _quality ][ param ] == -1 )
<a name="l00299"></a>00299                 <span class="keywordflow">return</span>;
<a name="l00300"></a>00300 
<a name="l00302"></a>00302         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( <a class="code" href="_gr_util_8cpp.html#cf8fae2ee0807b48ac9c5bdb8ae47583">GrGetShader</a>() == _glShader );
<a name="l00303"></a>00303 
<a name="l00305"></a>00305         <a class="code" href="_g_l_subsys_8cpp.html#4e9f22d939346ae7259124ded3a7fa69">bglUniform4fv</a>( _engineParamHandles[ _quality ][ param ], 1, data );
<a name="l00306"></a>00306 
<a name="l00309"></a>00309         <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00310"></a>00310 }
<a name="l00311"></a>00311 
<a name="l00312"></a>00312 <span class="comment">//----------------------------------------------------------</span>
<a name="l00313"></a>00313 <span class="keywordtype">void</span>
<a name="l00314"></a><a class="code" href="class_gr_shader.html#ba8fee7b0196c1585178d3248e7cc7ca">00314</a> <a class="code" href="class_gr_shader.html#ba8fee7b0196c1585178d3248e7cc7ca">GrShader::SetEngineParam4x2fv</a>( <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba" title="engine driven parameters.">EPARAM</a> <a class="code" href="glext_8h.html#c7c896d55e93a6cf7ff8524005b4e7b4">param</a>, <span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="_g_l_8h.html#89ce72163394e6aef63b551a8806e93f">data</a> )
<a name="l00315"></a>00315 {
<a name="l00317"></a>00317         <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00318"></a>00318 
<a name="l00320"></a>00320         <span class="keywordflow">if</span> ( _engineParamHandles[ _quality ][ param ] == -1 )
<a name="l00321"></a>00321                 <span class="keywordflow">return</span>;
<a name="l00322"></a>00322 
<a name="l00324"></a>00324         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( <a class="code" href="_gr_util_8cpp.html#cf8fae2ee0807b48ac9c5bdb8ae47583">GrGetShader</a>() == _glShader );
<a name="l00325"></a>00325 
<a name="l00327"></a>00327         <a class="code" href="_g_l_subsys_8cpp.html#081be21d448bc2c7ded07d25189cd2cc">bglUniformMatrix4x2fv</a>( _engineParamHandles[ _quality ][ param ], 1, <a class="code" href="_g_l_8h.html#06316bc3c17db78ce93419fb208945ba">GL_TRUE</a>, data );
<a name="l00328"></a>00328 
<a name="l00331"></a>00331         <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00332"></a>00332 }
<a name="l00333"></a>00333 
<a name="l00334"></a>00334 <span class="comment">//----------------------------------------------------------</span>
<a name="l00335"></a>00335 <span class="keywordtype">void</span>
<a name="l00336"></a><a class="code" href="class_gr_shader.html#8566055ca06bc953e0b58f6856b07a2b">00336</a> <a class="code" href="class_gr_shader.html#8566055ca06bc953e0b58f6856b07a2b">GrShader::SetEngineParam4x3fv</a>( <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba" title="engine driven parameters.">EPARAM</a> <a class="code" href="glext_8h.html#c7c896d55e93a6cf7ff8524005b4e7b4">param</a>, <span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="_g_l_8h.html#89ce72163394e6aef63b551a8806e93f">data</a> )
<a name="l00337"></a>00337 {
<a name="l00339"></a>00339         <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00340"></a>00340 
<a name="l00342"></a>00342         <span class="keywordflow">if</span> ( _engineParamHandles[ _quality ][ param ] == -1 )
<a name="l00343"></a>00343                 <span class="keywordflow">return</span>;
<a name="l00344"></a>00344 
<a name="l00346"></a>00346         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( <a class="code" href="_gr_util_8cpp.html#cf8fae2ee0807b48ac9c5bdb8ae47583">GrGetShader</a>() == _glShader );
<a name="l00347"></a>00347 
<a name="l00349"></a>00349         <a class="code" href="_g_l_subsys_8cpp.html#a99dcba76404279bead5b32c6516d1e3">bglUniformMatrix4x3fv</a>( _engineParamHandles[ _quality ][ param ], 1, <a class="code" href="_g_l_8h.html#06316bc3c17db78ce93419fb208945ba">GL_TRUE</a>, data );
<a name="l00350"></a>00350 
<a name="l00352"></a>00352         <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00353"></a>00353 }
<a name="l00354"></a>00354 
<a name="l00355"></a>00355 <span class="comment">//----------------------------------------------------------</span>
<a name="l00356"></a>00356 <span class="keywordtype">void</span>
<a name="l00357"></a><a class="code" href="class_gr_shader.html#c054492b117be764f4fd2440b7bd1020">00357</a> <a class="code" href="class_gr_shader.html#c054492b117be764f4fd2440b7bd1020">GrShader::SetEngineParam4x4fv</a>( <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba" title="engine driven parameters.">EPARAM</a> <a class="code" href="glext_8h.html#c7c896d55e93a6cf7ff8524005b4e7b4">param</a>, <span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code" href="_g_l_8h.html#89ce72163394e6aef63b551a8806e93f">data</a> )
<a name="l00358"></a>00358 {
<a name="l00360"></a>00360         <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00361"></a>00361 
<a name="l00363"></a>00363         <span class="keywordflow">if</span> ( _engineParamHandles[ _quality ][ param ] == -1 )
<a name="l00364"></a>00364                 <span class="keywordflow">return</span>;
<a name="l00365"></a>00365 
<a name="l00367"></a>00367         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( <a class="code" href="_gr_util_8cpp.html#cf8fae2ee0807b48ac9c5bdb8ae47583">GrGetShader</a>() == _glShader );
<a name="l00368"></a>00368 
<a name="l00370"></a>00370         <a class="code" href="_g_l_subsys_8cpp.html#206869294d403be7cd3c81a300f1035c">bglUniformMatrix4fv</a>( _engineParamHandles[ _quality ][ param ], 1, <a class="code" href="_g_l_8h.html#06316bc3c17db78ce93419fb208945ba">GL_TRUE</a>, data );
<a name="l00371"></a>00371 
<a name="l00373"></a>00373         <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00374"></a>00374 }
<a name="l00375"></a>00375 
<a name="l00376"></a>00376 <span class="comment">//----------------------------------------------------------</span>
<a name="l00377"></a>00377 <span class="keywordtype">void</span>
<a name="l00378"></a><a class="code" href="class_gr_shader.html#f32a4e5288174733e6460afac22c21c3">00378</a> <a class="code" href="class_gr_shader.html#f32a4e5288174733e6460afac22c21c3" title="make the shader current.">GrShader::Bind</a>( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> quality )
<a name="l00379"></a>00379 {
<a name="l00380"></a>00380         <span class="keywordflow">if</span> ( _needValidate[ quality ] )
<a name="l00381"></a>00381                 <a class="code" href="class_gr_shader.html#420e8f1956844878d2a8aeb09f0ab888">Validate</a>( quality );
<a name="l00382"></a>00382 
<a name="l00383"></a>00383         _glShader = _glShaders[ quality ];
<a name="l00384"></a>00384         _quality = quality;
<a name="l00385"></a>00385         <a class="code" href="_gr_util_8cpp.html#a40f94ecd4645027260b3217ce172cbe">GrBindShader</a>( _glShader );
<a name="l00386"></a>00386 }
<a name="l00387"></a>00387 
<a name="l00388"></a>00388 <span class="comment">//----------------------------------------------------------</span>
<a name="l00389"></a>00389 <span class="keywordtype">void</span>
<a name="l00390"></a><a class="code" href="class_gr_shader.html#2e574044a7d47d0a07d49a8a6f82fe06">00390</a> <a class="code" href="class_gr_shader.html#2e574044a7d47d0a07d49a8a6f82fe06" title="context reset notification.">GrShader::PreContextReset</a>()
<a name="l00391"></a>00391 {
<a name="l00393"></a>00393         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033bfb5dc4b6ee1d1f5d0b224995dd28093">EGQ_COUNT</a>; ++i )
<a name="l00394"></a>00394         {
<a name="l00395"></a>00395                 <a class="code" href="_g_l_subsys_8cpp.html#e730a287f86c5675b43e5bdf8be81032">bglDeleteProgram</a>( _glShaders[ i ] );
<a name="l00396"></a>00396                 <a class="code" href="_g_l_subsys_8cpp.html#9ab50de5f85395cba3f53a92df95c783">bglDeleteShader</a>( _glVertShaders[ i ] );
<a name="l00397"></a>00397                 <a class="code" href="_g_l_subsys_8cpp.html#9ab50de5f85395cba3f53a92df95c783">bglDeleteShader</a>( _glFragShaders[ i ] );
<a name="l00398"></a>00398         }
<a name="l00399"></a>00399 }
<a name="l00400"></a>00400 
<a name="l00401"></a>00401 <span class="comment">//----------------------------------------------------------</span>
<a name="l00402"></a>00402 <span class="keywordtype">void</span>
<a name="l00403"></a><a class="code" href="class_gr_shader.html#5a508bd00cf8c3536028294bc8f6badc">00403</a> <a class="code" href="class_gr_shader.html#5a508bd00cf8c3536028294bc8f6badc">GrShader::PostContextReset</a>()
<a name="l00404"></a>00404 {
<a name="l00406"></a>00406         Build();
<a name="l00407"></a>00407 }
<a name="l00408"></a>00408 
<a name="l00409"></a>00409 
<a name="l00410"></a>00410 <span class="comment">//==========================================================</span>
<a name="l00412"></a>00412 <span class="comment"></span><span class="comment">//==========================================================</span>
<a name="l00413"></a>00413 
<a name="l00414"></a>00414 <span class="comment">//----------------------------------------------------------</span>
<a name="l00415"></a>00415 <span class="keywordtype">void</span>
<a name="l00416"></a>00416 GrShader::Build()
<a name="l00417"></a>00417 {
<a name="l00418"></a>00418         <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00419"></a>00419 
<a name="l00421"></a>00421         FreeShaders();
<a name="l00422"></a>00422 
<a name="l00424"></a>00424         <a class="code" href="common__afx_8h.html#816fa58fd77499b0edb2c69ebe803d5c" title="include BootstrapFS.">tstring</a> errors;
<a name="l00425"></a>00425         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033bfb5dc4b6ee1d1f5d0b224995dd28093">EGQ_COUNT</a>; ++i )
<a name="l00426"></a>00426         {
<a name="l00428"></a>00428                 <span class="keywordflow">if</span> ( !BuildProgram( _vSource.c_str(), _fSource.c_str(), errors, ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i ) )
<a name="l00429"></a>00429                 {
<a name="l00432"></a>00432                         BuildProgram( kErrorShaderVS, kErrorShaderFS, errors, ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i );
<a name="l00433"></a>00433                 }
<a name="l00434"></a>00434 
<a name="l00436"></a>00436                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba30e37abd2fd8b590c15664405e826b85" title="vertex params.">EP_MODEL_VIEW_PROJECTION_MATRIX</a>,      <a class="code" href="_gr_config_8h.html#a244886d1ff9da48a9c12a010ac06654" title="engine driven shader param names">GR_MODEL_VIEW_PROJECTION_MATRIX_NAME</a>,   <a class="code" href="glext_8h.html#f2f9eda8aec4c169cf1800b61ead61fb">GL_FLOAT_MAT4</a> );
<a name="l00437"></a>00437                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba771c68fe14e6f3d88ceab8faa6b409e0">EP_MODEL_VIEW_MATRIX</a>,                 <a class="code" href="_gr_config_8h.html#3bf3a34c66f267922e61f7abf37afa5b">GR_MODEL_VIEW_MATRIX_NAME</a>,                      <a class="code" href="glext_8h.html#f2f9eda8aec4c169cf1800b61ead61fb">GL_FLOAT_MAT4</a> );
<a name="l00438"></a>00438                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba5fb8b055e849e72981bbccd2019bdcd8">EP_LOCAL_VIEW_POSITION</a>,               <a class="code" href="_gr_config_8h.html#22bf8e86d53458bac047b8541504b765">GR_LOCAL_VIEW_POSITION_NAME</a>,            <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00439"></a>00439                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba5e5bd686b1a544fca8ccd8172614ac52">EP_LOCAL_LIGHT_POSITION</a>,              <a class="code" href="_gr_config_8h.html#32bced1706fe1306726edea9b26d05d8">GR_LOCAL_LIGHT_POSITION_NAME</a>,           <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00440"></a>00440                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7baf6e9d758af54b6143f365279e578b26a">EP_LOCAL_LIGHT_DIR_OVERRIDE</a>,  <a class="code" href="_gr_config_8h.html#08cbd9be8396070da94bd6be05e88385">GR_LOCAL_LIGHT_DIR_OVERRIDE_NAME</a>,       <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00441"></a>00441                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7baf849900dac3995949e0c3b9b78d3fd53" title="{ x, y, z, 0 = override, 1 = no override }">EP_LIGHT_PROJECTION_MATRIX</a>,   <a class="code" href="_gr_config_8h.html#3e5b624f124732d93e101b5f7086b541">GR_LIGHT_PROJECTION_MATRIX_NAME</a>,        <a class="code" href="glext_8h.html#f2f9eda8aec4c169cf1800b61ead61fb">GL_FLOAT_MAT4</a> );
<a name="l00442"></a>00442                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7babfde6f4b246ad7c4925577065f67841e" title="4x4 projection matrix.">EP_SHADOW_PROJECTION_MATRIX</a>,  <a class="code" href="_gr_config_8h.html#902fb349732d05ba59f27494c16f3fe6">GR_SHADOW_PROJECTION_MATRIX_NAME</a>,       <a class="code" href="glext_8h.html#f2f9eda8aec4c169cf1800b61ead61fb">GL_FLOAT_MAT4</a> );
<a name="l00443"></a>00443                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba044e51cf06ee7b28315c5162ecac92df" title="4x4 projection matrix.">EP_TEXTURE_MATRIX</a>,                    <a class="code" href="_gr_config_8h.html#ba766f35b1c6ac3ad163b7c36eeeaa18">GR_TEXTURE_MATRIX_NAME</a>,                         <a class="code" href="glext_8h.html#73de4bfbe1d597cd11fb3d60ed830c31">GL_FLOAT_MAT4x2</a> );
<a name="l00444"></a>00444                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7baabc9a760b45ea9435385731ca546ac12" title="4x2 projection matrix.">EP_CUR_RENDER_TEXTURE_MATRIX</a>, <a class="code" href="_gr_config_8h.html#8d7cad6b2d5cdcef3551e3cff6537a92">GR_CUR_RENDER_TEXTURE_MATRIX_NAME</a>,      <a class="code" href="glext_8h.html#73de4bfbe1d597cd11fb3d60ed830c31">GL_FLOAT_MAT4x2</a> );
<a name="l00445"></a>00445                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7baaebe8f389fe4e9c1cf88232822ed6db6">EP_ENV_TEXGEN_TEXTURE_MATRIX</a>, <a class="code" href="_gr_config_8h.html#01f5ddaafcf927d029df942baac1d53a">GR_ENV_TEXGEN_TEXTURE_MATRIX_NAME</a>,      <a class="code" href="glext_8h.html#fa821271f6254cd1623a1311e608df17">GL_FLOAT_MAT4x3</a> );
<a name="l00446"></a>00446                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba53e6fa76e5acfea0ca6ed613667346b2">EP_VERTEX_COLOR_MOD</a>,                  <a class="code" href="_gr_config_8h.html#b62796b004bea47700135f1c45750dfe">GR_VERTEX_COLOR_MOD_NAME</a>,                       <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00447"></a>00447                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7babca9fc6c0444334899a6d1c2b6da7a4b">EP_VERTEX_COLOR_ADD</a>,                  <a class="code" href="_gr_config_8h.html#1dfd5678a411515184fa3afe7c2d80d2">GR_VERTEX_COLOR_ADD_NAME</a>,                       <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00448"></a>00448 
<a name="l00450"></a>00450                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7bad3821a583087b6f09500c427bb2c9136" title="fragment params.">EP_SHADOW_NEAR_CLIP</a>,                  <a class="code" href="_gr_config_8h.html#b3c88c73d70f3a614620213002811961">GR_SHADOW_NEAR_CLIP_NAME</a>,                       <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00451"></a>00451                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba7018c4410472cd890a2e12990994dc96">EP_LIGHT_COLOR</a>,                               <a class="code" href="_gr_config_8h.html#4267f310884a379af74a2141270a339b">GR_LIGHT_COLOR_NAME</a>,                            <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00452"></a>00452                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7bab4efd66311bfcdd650de1fbc296c315f">EP_LIGHT_RANGE</a>,                               <a class="code" href="_gr_config_8h.html#561d5c9d7011e6dc85e9b10d73d12737">GR_LIGHT_RANGE_NAME</a>,                            <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00453"></a>00453                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7bad6e079e2952c61ea73b33b0be55ae1bb" title="{ r, r, r, 1/r }">EP_LIGHT_ATTEN</a>,                               <a class="code" href="_gr_config_8h.html#bfa0d12e884a4309e7db872e2dcf6b00">GR_LIGHT_ATTEN_NAME</a>,                            <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00454"></a>00454                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7baad8d46e4d63c30652cfe863781d31eef" title="{ a^2, a, 0, c }">EP_AMBIENT_COLOR</a>,                             <a class="code" href="_gr_config_8h.html#072d7094f320147cc8d8b53f9e8d6b83">GR_AMBIENT_COLOR_NAME</a>,                          <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00455"></a>00455                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba3f52eed666dad2ab377a721dec7d48c2">EP_BUMP_MOD</a>,                                  <a class="code" href="_gr_config_8h.html#b4f88a6377f80f2da87aebe9899f83af">GR_BUMP_MOD_NAME</a>,                                       <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00456"></a>00456                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7baca21fbc32f19ff7f96d197e91fa8241f">EP_BUMP_ADD</a>,                                  <a class="code" href="_gr_config_8h.html#9df6e5f633461775b59cc31982879ca0">GR_BUMP_ADD_NAME</a>,                                       <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00457"></a>00457                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7babd45973b924f00252c2b0119fe5b3fe5">EP_DIFFUSE_MOD</a>,                               <a class="code" href="_gr_config_8h.html#87685cfc4006443517fef41b16afa899">GR_DIFFUSE_MOD_NAME</a>,                            <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00458"></a>00458                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba2a9f47816bdefe2925a532af749de481">EP_DIFFUSE_ADD</a>,                               <a class="code" href="_gr_config_8h.html#fa5013a1d7ba67b2ab35aeb70f337bbd">GR_DIFFUSE_ADD_NAME</a>,                            <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00459"></a>00459                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba34e4a46829351d19558379ff1494375d">EP_SPECULAR_MOD</a>,                              <a class="code" href="_gr_config_8h.html#695e57772e10b0ec85689b821f1b0f59">GR_SPECULAR_MOD_NAME</a>,                           <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00460"></a>00460                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba92003f10db0b04b9d2230108be48e2e0">EP_SPECULAR_ADD</a>,                              <a class="code" href="_gr_config_8h.html#f52882e1f8170a8de7068d9e84b9972a">GR_SPECULAR_ADD_NAME</a>,                           <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00461"></a>00461                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7baae7cb3eac81d8f1030bc823f55ebebc2">EP_EMISSIVE_MOD</a>,                              <a class="code" href="_gr_config_8h.html#a09af4ef623b2b66b8b8fa7ad5e649ac">GR_EMISSIVE_MOD_NAME</a>,                           <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00462"></a>00462                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba8c8aaf9c9578270a5014a329d810bebd">EP_EMISSIVE_ADD</a>,                              <a class="code" href="_gr_config_8h.html#56673217f89994339a18506c227d553b">GR_EMISSIVE_ADD_NAME</a>,                           <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00463"></a>00463                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba86a132318fcf5a928f1666362820d223">EP_AMBIENT_MOD</a>,                               <a class="code" href="_gr_config_8h.html#1cf31c0e7201b7fe5e4ed72291e2a3c3">GR_AMBIENT_MOD_NAME</a>,                            <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00464"></a>00464                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba651d45a736222bdf3a1901ba4784418f">EP_AMBIENT_ADD</a>,                               <a class="code" href="_gr_config_8h.html#fafcdc3dda97277474d17739dcc8f4b9">GR_AMBIENT_ADD_NAME</a>,                            <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00465"></a>00465                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7baec11ff622b6f49a33251e0a9626fb106">EP_LIGHT_WIDTH</a>,                               <a class="code" href="_gr_config_8h.html#3f5ef05d7b03e3d028a6ac13629e30da">GR_LIGHT_WIDTH_NAME</a>,                            <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00466"></a>00466                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7bae24509787b39e7258a4e25ecf2663e5d" title="{ w, w, -w, 0 }">EP_LIGHT_HAZE</a>,                                <a class="code" href="_gr_config_8h.html#7dbde0f141cdb30968dbf94eb90589e6">GR_LIGHT_HAZE_NAME</a>,                                     <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00467"></a>00467                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7bac116d1d297985a8983047e69c8f8c1d6" title="{ h, 1-h, 0, 0 }">EP_FOG_START</a>,                                 <a class="code" href="_gr_config_8h.html#b9e5e3f005f49fe44efa067ca041e20a">GR_FOG_START_NAME</a>,                                      <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00468"></a>00468                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7bad96706cfb5f9b798c98f8c12bb6b0862">EP_FOG_RANGE</a>,                                 <a class="code" href="_gr_config_8h.html#9a5e9c0d821d62bf64620b8f9fd5e00d">GR_FOG_RANGE_NAME</a>,                                      <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00469"></a>00469                 InitEngineParam( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba74327915bc548e45e31bbe4ffc1f6336">EP_FOG_COLOR</a>,                                 <a class="code" href="_gr_config_8h.html#1db4933d99302143f8150a5d10799420">GR_FOG_COLOR_NAME</a>,                                      <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a> );
<a name="l00470"></a>00470 
<a name="l00472"></a>00472                 InitEngineSampler( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="_gr_config_8h.html#cf8f23a7cbbab43e9ae41f5242728ba5" title="engine driven shader sampler names">GR_TEX_CUBE_NORMALIZE_NAME</a>, <a class="code" href="_gr_config_8h.html#e7ef96b3ca82fe304a8c6c51440a7d4d" title="light pass.">GR_TEX_CUBE_NORMALIZE</a>,                          <a class="code" href="glext_8h.html#efd2fef024ff66a2823dfdc1639fb6ad">GL_SAMPLER_CUBE</a> );
<a name="l00473"></a>00473                 InitEngineSampler( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="_gr_config_8h.html#67bfc31e9a03d13a1a8ce45edf8559b3">GR_TEX_SHADOW_VSM_CUBE_NAME</a>,<a class="code" href="_gr_config_8h.html#e1952de8139d52eb7591acdc1276b4da">GR_TEX_SHADOW_VSM_CUBE</a>,                         <a class="code" href="glext_8h.html#efd2fef024ff66a2823dfdc1639fb6ad">GL_SAMPLER_CUBE</a> );
<a name="l00474"></a>00474                 InitEngineSampler( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="_gr_config_8h.html#18cc2383b74dbd9440acf0f7995626a9">GR_TEX_CUBE_FACE_X_NAME</a>,    <a class="code" href="_gr_config_8h.html#97e767c8c7cbfe99cfd43fa3ea038b33">GR_TEX_CUBE_FACE_X</a>,                                     <a class="code" href="glext_8h.html#efd2fef024ff66a2823dfdc1639fb6ad">GL_SAMPLER_CUBE</a> );
<a name="l00475"></a>00475                 InitEngineSampler( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="_gr_config_8h.html#b080fb059ddea5fd6f75e44e633f8de5">GR_TEX_CUBE_FACE_Y_NAME</a>,    <a class="code" href="_gr_config_8h.html#1616ae908f85ee17608c84d0a37eb308">GR_TEX_CUBE_FACE_Y</a>,                                     <a class="code" href="glext_8h.html#efd2fef024ff66a2823dfdc1639fb6ad">GL_SAMPLER_CUBE</a> );
<a name="l00476"></a>00476                 InitEngineSampler( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="_gr_config_8h.html#d5e18e8ea5e3ce8e1b22b4bfd9a43b27">GR_TEX_JITTER_NAME</a>,                 <a class="code" href="_gr_config_8h.html#39d18adbb5ca56c768c611f210165911">GR_TEX_JITTER</a>,                                          <a class="code" href="glext_8h.html#cbaf67c05cdb5290f748c28ca878e537">GL_SAMPLER_3D</a> );
<a name="l00477"></a>00477                 InitEngineSampler( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="_gr_config_8h.html#c8ec5b8654990769092b5b6623014a10">GR_TEX_SHADOW_NAME</a>,                 <a class="code" href="_gr_config_8h.html#ba00b10a71e10165eb0cf558653afa68">GR_TEX_SHADOW</a>,                                          <a class="code" href="glext_8h.html#e021158f10f94bab8f7d9349f90891e5">GL_SAMPLER_2D_SHADOW</a> );
<a name="l00478"></a>00478                 InitEngineSampler( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="_gr_config_8h.html#9d7eac79adb8e19e294b986c72040f77">GR_TEX_PROJECTION_NAME</a>,             <a class="code" href="_gr_config_8h.html#0950fdacb51de9f1e0cefc9ed4cad3d2">GR_TEX_PROJECTION</a>,                                      <a class="code" href="glext_8h.html#166645e482b60d35b1d31c2f6f378238">GL_SAMPLER_2D</a> );
<a name="l00479"></a>00479                 InitEngineSampler( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="_gr_config_8h.html#9775ee5e7e2309b38815852711d7fa1e">GR_TEX_ATLAS_NAME</a>,                  <a class="code" href="_gr_config_8h.html#ab801dd22858443db75457a6107fe82e">GR_TEX_ATLAS</a>,                                           <a class="code" href="glext_8h.html#166645e482b60d35b1d31c2f6f378238">GL_SAMPLER_2D</a> );
<a name="l00480"></a>00480 
<a name="l00481"></a>00481                 InitEngineSampler( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="_gr_config_8h.html#dd523cd1f6b29452546640d594959344">GR_TEX_BUMP_NAME</a>,                   <a class="code" href="_gr_config_8h.html#4efb41e353cc885eb72be8fb688fc5d4">GR_TEX_BUMP</a>,                                            <a class="code" href="glext_8h.html#166645e482b60d35b1d31c2f6f378238">GL_SAMPLER_2D</a> );
<a name="l00482"></a>00482                 InitEngineSampler( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="_gr_config_8h.html#19013c91abc0bc673188effdddfa7e6a">GR_TEX_NORMAL_NAME</a>,                 <a class="code" href="_gr_config_8h.html#d1a00f490cd31d0c1c9110e7b353c91e">GR_TEX_NORMAL</a>,                                          <a class="code" href="glext_8h.html#166645e482b60d35b1d31c2f6f378238">GL_SAMPLER_2D</a> );
<a name="l00483"></a>00483                 InitEngineSampler( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="_gr_config_8h.html#89b249ae32c8bb26f3b1fee6f63e6f70">GR_TEX_DIFFUSE_NAME</a>,                <a class="code" href="_gr_config_8h.html#414a361b34dcaaf2c98e12af6d40752c">GR_TEX_DIFFUSE</a>,                                         <a class="code" href="glext_8h.html#166645e482b60d35b1d31c2f6f378238">GL_SAMPLER_2D</a> );
<a name="l00484"></a>00484                 InitEngineSampler( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="_gr_config_8h.html#66e3f5c69b9cbc254f1dd2a174acd994">GR_TEX_SPECULAR_NAME</a>,               <a class="code" href="_gr_config_8h.html#479f147a9ef37952111511c0be79e229">GR_TEX_SPECULAR</a>,                                        <a class="code" href="glext_8h.html#166645e482b60d35b1d31c2f6f378238">GL_SAMPLER_2D</a> );
<a name="l00485"></a>00485 
<a name="l00486"></a>00486 <span class="comment">//              InitEngineSampler( ( EGRQUALITY )i, GR_TEX_REFLECTION_NAME,             GR_TEX_REFLECTION,                                      GL_SAMPLER_2D );</span>
<a name="l00487"></a>00487 <span class="comment">//              InitEngineSampler( ( EGRQUALITY )i, GR_TEX_ENVMAP_NAME,                 GR_TEX_ENVMAP,                                          GL_SAMPLER_CUBE );</span>
<a name="l00488"></a>00488 
<a name="l00489"></a>00489                 InitEngineSampler( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="_gr_config_8h.html#7cb494d695809e55c41dfd28cac13131">GR_TEX_CUR_RENDER_NAME</a>,             <a class="code" href="_gr_config_8h.html#2b8837debcee61e82ce18a7c5a97a7cf" title="misc textures.">GR_TEX_CUR_RENDER</a>,                                      <a class="code" href="glext_8h.html#166645e482b60d35b1d31c2f6f378238">GL_SAMPLER_2D</a> );
<a name="l00490"></a>00490                 InitEngineSampler( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="_gr_config_8h.html#b174b9c549bc4f5d6bcd4edcf12f8f08">GR_TEX_CUR_DEPTH_NAME</a>,              <a class="code" href="_gr_config_8h.html#4e082342f05c4e9e8f6cf0b91599e13f">GR_TEX_CUR_DEPTH</a>,                                       <a class="code" href="glext_8h.html#166645e482b60d35b1d31c2f6f378238">GL_SAMPLER_2D</a> );
<a name="l00491"></a>00491                 InitEngineSampler( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="_gr_config_8h.html#84f16f77011f22ba179d2e363922212f">GR_TEX_STIPPLE_NAME</a>,                <a class="code" href="_gr_config_8h.html#57e641218e886e20f56f27649161665d" title="engine driven samplers">GR_TEX_STIPPLE</a>,                                         <a class="code" href="glext_8h.html#166645e482b60d35b1d31c2f6f378238">GL_SAMPLER_2D</a> );
<a name="l00492"></a>00492                 InitEngineSampler( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="_gr_config_8h.html#86444c776cbfed72fc070ed7a1b87cfb">GR_TEX_AMBIENT_NAME</a>,                <a class="code" href="_gr_config_8h.html#a57484f78b83bd899a9a628b9eac00e2">GR_TEX_AMBIENT</a>,                                         <a class="code" href="glext_8h.html#166645e482b60d35b1d31c2f6f378238">GL_SAMPLER_2D</a> );
<a name="l00493"></a>00493                 InitEngineSampler( ( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> )i, <a class="code" href="_gr_config_8h.html#eb57f94cd6d735deab93619b1bdab6c3">GR_TEX_EMISSIVE_NAME</a>,               <a class="code" href="_gr_config_8h.html#42e10dc24eb1b2dc505beed813fbc924">GR_TEX_EMISSIVE</a>,                                        <a class="code" href="glext_8h.html#166645e482b60d35b1d31c2f6f378238">GL_SAMPLER_2D</a> );
<a name="l00494"></a>00494 
<a name="l00495"></a>00495                 <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00496"></a>00496         }
<a name="l00497"></a>00497 
<a name="l00499"></a>00499         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_gr_shader.html#32d823afd380bcdf283ed2e667cf66cb">kMaxUserParams</a>; ++i )
<a name="l00500"></a>00500         {
<a name="l00501"></a>00501                 <span class="keywordflow">if</span> ( _userParams[ i ].<a class="code" href="glext_8h.html#f7477b8725fcf509c9623f64b9d09164">name</a>.length() &gt; 0 )
<a name="l00502"></a>00502                         GetUserParamInfo( _userParams + i );
<a name="l00503"></a>00503         }
<a name="l00504"></a>00504 
<a name="l00506"></a>00506         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_gr_shader.html#cbaa822de5def45617ccfb833996864e">kMaxUserSamplers</a>; ++i )
<a name="l00507"></a>00507         {
<a name="l00508"></a>00508                 <span class="keywordflow">if</span> ( _userSamplers[ i ].<a class="code" href="glext_8h.html#f7477b8725fcf509c9623f64b9d09164">name</a>.length() &gt; 0 )
<a name="l00509"></a>00509                         SetUserSamplerUniform( _userSamplers[ i ].<a class="code" href="glext_8h.html#f7477b8725fcf509c9623f64b9d09164">name</a>.c_str(), _userSamplers[ i ].texUnit );
<a name="l00510"></a>00510         }
<a name="l00511"></a>00511 
<a name="l00513"></a>00513         <a class="code" href="common__afx_8h.html#9f04579206286b6dc8c9708063450144" title="memory functions.">MemSet</a>( _needValidate, 1, <span class="keyword">sizeof</span>( _needValidate ) );
<a name="l00514"></a>00514 }
<a name="l00515"></a>00515 
<a name="l00516"></a>00516 <span class="comment">//----------------------------------------------------------</span>
<a name="l00517"></a>00517 <span class="keywordtype">bool</span>
<a name="l00518"></a>00518 GrShader::BuildProgram( <span class="keyword">const</span> <span class="keywordtype">char</span>* vsText, <span class="keyword">const</span> <span class="keywordtype">char</span>* fsText, <a class="code" href="common__afx_8h.html#816fa58fd77499b0edb2c69ebe803d5c" title="include BootstrapFS.">tstring</a>&amp; errorMsg, <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> quality )
<a name="l00519"></a>00519 {
<a name="l00521"></a>00521         <span class="keywordtype">char</span> qualityLevel[10];
<a name="l00522"></a>00522         <span class="keyword">const</span> <span class="keywordtype">char</span>* strTable[] = 
<a name="l00523"></a>00523         {
<a name="l00524"></a>00524                 <a class="code" href="_gr_shader_8cpp.html#31824ada48c520a48ebb8b6475b742a1">GLSL_VERSION_STRING</a>,
<a name="l00525"></a>00525                 <span class="stringliteral">"#define B_QUALITY "</span>,
<a name="l00526"></a>00526                 qualityLevel,
<a name="l00527"></a>00527                 <span class="stringliteral">"\n"</span>
<a name="l00528"></a>00528 <span class="preprocessor">#if GR_OPTION_FRAGMENT_HALF</span>
<a name="l00529"></a>00529 <span class="preprocessor"></span>                <span class="stringliteral">"#if !defined __GLSL_CG_DATA_TYPES\n"</span>
<a name="l00530"></a>00530                 <span class="stringliteral">"#define __GLSL_CG_DATA_TYPES\n"</span>
<a name="l00531"></a>00531 <span class="preprocessor">#endif</span>
<a name="l00532"></a>00532 <span class="preprocessor"></span>                <span class="stringliteral">"#define half float\n"</span>
<a name="l00533"></a>00533                 <span class="stringliteral">"#define half4 vec4\n"</span>
<a name="l00534"></a>00534                 <span class="stringliteral">"#define half3 vec3\n"</span>
<a name="l00535"></a>00535                 <span class="stringliteral">"#define half2 vec2\n"</span>
<a name="l00536"></a>00536 <span class="preprocessor">#if GR_OPTION_FRAGMENT_HALF</span>
<a name="l00537"></a>00537 <span class="preprocessor"></span>                <span class="stringliteral">"#endif\n"</span>
<a name="l00538"></a>00538 <span class="preprocessor">#endif</span>
<a name="l00539"></a>00539 <span class="preprocessor"></span>                <span class="stringliteral">"#extension GL_ARB_texture_rectangle : enable\n"</span>,
<a name="l00540"></a>00540                 <span class="stringliteral">"#line 1\n"</span>,
<a name="l00541"></a>00541                 0,
<a name="l00542"></a>00542         };
<a name="l00543"></a>00543         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> kIndexCount = <span class="keyword">sizeof</span>( strTable ) / <span class="keyword">sizeof</span>( <span class="keyword">const</span> <span class="keywordtype">char</span>* );
<a name="l00544"></a>00544         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> kSrcIndex = kIndexCount - 1;
<a name="l00545"></a>00545 
<a name="l00547"></a>00547         <a class="code" href="graphics__afx_8h.html#3759cdcb8b8514d0ac5ebd5e9b55c59a">_itoa_s</a>( quality, qualityLevel, 10, 10 );
<a name="l00548"></a>00548 
<a name="l00550"></a>00550         strTable[ kSrcIndex ] = vsText;
<a name="l00551"></a>00551         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vertexShader = <a class="code" href="_g_l_subsys_8cpp.html#37ae9ae6c427800b1481b19e887ec4cb">bglCreateShader</a>( <a class="code" href="glext_8h.html#ceb29bc16e885f956eb9e351a7dd6276">GL_VERTEX_SHADER</a> );
<a name="l00552"></a>00552         <span class="keywordflow">if</span> ( !CompileShader( vertexShader, kIndexCount, strTable, errorMsg ) )
<a name="l00553"></a>00553         {
<a name="l00555"></a>00555                 <a class="code" href="_g_l_subsys_8cpp.html#9ab50de5f85395cba3f53a92df95c783">bglDeleteShader</a>( vertexShader );
<a name="l00556"></a>00556                 <a class="code" href="common__afx_8cpp.html#f1a1e0f08b49000974368246e5b97f84" title="debug output/console output function.">PrintF</a>( <span class="stringliteral">"Error compiling vertex shader...\n%s"</span>, errorMsg.c_str() );
<a name="l00557"></a>00557                 <span class="keywordflow">return</span> 0;
<a name="l00558"></a>00558         }
<a name="l00559"></a>00559 
<a name="l00561"></a>00561         strTable[ kSrcIndex ] = fsText;
<a name="l00562"></a>00562         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fragmentShader = <a class="code" href="_g_l_subsys_8cpp.html#37ae9ae6c427800b1481b19e887ec4cb">bglCreateShader</a>( <a class="code" href="glext_8h.html#1a0294662b50921555cae95fb20740d4">GL_FRAGMENT_SHADER</a> );
<a name="l00563"></a>00563         <span class="keywordflow">if</span> ( !CompileShader( fragmentShader, kIndexCount, strTable, errorMsg ) )
<a name="l00564"></a>00564         {
<a name="l00565"></a>00565                 <a class="code" href="_g_l_subsys_8cpp.html#9ab50de5f85395cba3f53a92df95c783">bglDeleteShader</a>( vertexShader );
<a name="l00566"></a>00566                 <a class="code" href="_g_l_subsys_8cpp.html#9ab50de5f85395cba3f53a92df95c783">bglDeleteShader</a>( fragmentShader );
<a name="l00567"></a>00567                 <a class="code" href="common__afx_8cpp.html#f1a1e0f08b49000974368246e5b97f84" title="debug output/console output function.">PrintF</a>( <span class="stringliteral">"Error compiling fragment shader...\n%s"</span>, errorMsg.c_str() );
<a name="l00568"></a>00568                 <span class="keywordflow">return</span> 0;
<a name="l00569"></a>00569         }
<a name="l00570"></a>00570 
<a name="l00572"></a>00572         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="glext_8h.html#b55c179cd6c84b3f5ddc11d9da0f55b4">program</a> = <a class="code" href="_g_l_subsys_8cpp.html#7e88834fa936f4bfffbfdd1a4fa924c6">bglCreateProgram</a>();
<a name="l00573"></a>00573         <a class="code" href="_g_l_subsys_8cpp.html#0f4ca5a2ad2421494d73d78fed8048e8">bglAttachShader</a>( program, vertexShader );
<a name="l00574"></a>00574         <a class="code" href="_g_l_subsys_8cpp.html#0f4ca5a2ad2421494d73d78fed8048e8">bglAttachShader</a>( program, fragmentShader );
<a name="l00575"></a>00575 
<a name="l00577"></a>00577         <a class="code" href="_g_l_subsys_8cpp.html#db8713f1b2809f0f70e470d41f9c0fa5">bglBindAttribLocation</a>( program,         <a class="code" href="_gr_config_8h.html#33937cf4e463ed1ab31e357ce0a39dd8" title="engine driven shader attributes.">GR_ATTRIB_POSITION_INDEX</a>,               <a class="code" href="_gr_config_8h.html#443fd5a40c2436629a38525d200ec892" title="engine driven shader attribute names">GR_ATTRIB_POSITION_NAME</a> );
<a name="l00578"></a>00578         <a class="code" href="_g_l_subsys_8cpp.html#db8713f1b2809f0f70e470d41f9c0fa5">bglBindAttribLocation</a>( program,         <a class="code" href="_gr_config_8h.html#b8e8a3539ff60c8bab0acff086415755">GR_ATTRIB_TANGENT_INDEX</a>,                <a class="code" href="_gr_config_8h.html#3a6f9f82138188610bb1afb1a0b9c9b4">GR_ATTRIB_TANGENT_NAME</a>  );
<a name="l00579"></a>00579         <a class="code" href="_g_l_subsys_8cpp.html#db8713f1b2809f0f70e470d41f9c0fa5">bglBindAttribLocation</a>( program,         <a class="code" href="_gr_config_8h.html#864b47f5e0ca36430400d0e1686bb9eb">GR_ATTRIB_BINORMAL_INDEX</a>,               <a class="code" href="_gr_config_8h.html#5dde00a6e34c76e07f1c02bb01b93ff0">GR_ATTRIB_BINORMAL_NAME</a> );
<a name="l00580"></a>00580         <a class="code" href="_g_l_subsys_8cpp.html#db8713f1b2809f0f70e470d41f9c0fa5">bglBindAttribLocation</a>( program,         <a class="code" href="_gr_config_8h.html#a08ad79ec4b1c64202c9719c47fcf5e5">GR_ATTRIB_NORMAL_INDEX</a>,                 <a class="code" href="_gr_config_8h.html#6c3747c1fb3e974c8d3f2e575b524832">GR_ATTRIB_NORMAL_NAME</a>   );
<a name="l00581"></a>00581         <a class="code" href="_g_l_subsys_8cpp.html#db8713f1b2809f0f70e470d41f9c0fa5">bglBindAttribLocation</a>( program,         <a class="code" href="_gr_config_8h.html#d1654657bd162d8d8d2c1670c4e11edc">GR_ATTRIB_TEXCOORD_INDEX</a>,               <a class="code" href="_gr_config_8h.html#ce2264321c4343af03aa6a9be65a2bcd">GR_ATTRIB_TEXCOORD_NAME</a> );
<a name="l00582"></a>00582         <a class="code" href="_g_l_subsys_8cpp.html#db8713f1b2809f0f70e470d41f9c0fa5">bglBindAttribLocation</a>( program,         <a class="code" href="_gr_config_8h.html#40a383e472015e4d246847562a7375cd">GR_ATTRIB_COLOR_INDEX</a>,                  <a class="code" href="_gr_config_8h.html#110edb8074d409afb6e64f388ac56de5">GR_ATTRIB_COLOR_NAME</a>    );
<a name="l00583"></a>00583 
<a name="l00585"></a>00585         <span class="keywordtype">int</span> status = <a class="code" href="_g_l_8h.html#06316bc3c17db78ce93419fb208945ba">GL_TRUE</a>;
<a name="l00586"></a>00586         <a class="code" href="_g_l_subsys_8cpp.html#30e15956be6bd30d2d5deeaa5b779d12">bglLinkProgram</a>( program );
<a name="l00587"></a>00587         <a class="code" href="_g_l_subsys_8cpp.html#10a0d7fb5af71d8198f925061445940a">bglGetProgramiv</a>( program, <a class="code" href="glext_8h.html#e644ef6b281c9378fa49d9b1ccefaf31">GL_LINK_STATUS</a>, &amp;status );
<a name="l00588"></a>00588 
<a name="l00590"></a>00590         <a class="code" href="common__afx_8h.html#816fa58fd77499b0edb2c69ebe803d5c" title="include BootstrapFS.">tstring</a> <a class="code" href="glext_8h.html#66ecd5782c3b54799e8ac9edad536e74">infoLog</a>;
<a name="l00591"></a>00591         GetProgramInfoLog( program, infoLog );
<a name="l00592"></a>00592         <span class="keywordflow">if</span> ( status == <a class="code" href="_g_l_8h.html#bca6d43f43fae31f49dcb883b2f301f6">GL_FALSE</a> )
<a name="l00593"></a>00593         {
<a name="l00594"></a>00594                 <a class="code" href="_g_l_subsys_8cpp.html#9ab50de5f85395cba3f53a92df95c783">bglDeleteShader</a>( vertexShader );
<a name="l00595"></a>00595                 <a class="code" href="_g_l_subsys_8cpp.html#9ab50de5f85395cba3f53a92df95c783">bglDeleteShader</a>( fragmentShader );
<a name="l00596"></a>00596                 <a class="code" href="_g_l_subsys_8cpp.html#e730a287f86c5675b43e5bdf8be81032">bglDeleteProgram</a>( program );
<a name="l00597"></a>00597                 PostError( <span class="stringliteral">"Error linking shader...\n%s"</span>, infoLog.c_str() );
<a name="l00598"></a>00598         }
<a name="l00599"></a>00599         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( quality == <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033a65aecaadc4e83e6faf13f9983899775">EGQ_LOW</a> &amp;&amp; infoLog.length() &gt; 2 )
<a name="l00600"></a>00600                 <a class="code" href="common__afx_8cpp.html#f1a1e0f08b49000974368246e5b97f84" title="debug output/console output function.">PrintF</a>( <span class="stringliteral">"Shader %s compiled successfully.  Info:\n%s"</span>, _name.<a class="code" href="class_u_path.html#970648bc09145c6da1712022d84ad3b7" title="returns the path string.">GetPathString</a>().c_str(), infoLog.c_str() );
<a name="l00601"></a>00601 
<a name="l00603"></a>00603         _glShaders[ quality ] = program;
<a name="l00604"></a>00604         _glVertShaders[ quality ] = vertexShader;
<a name="l00605"></a>00605         _glFragShaders[ quality ] = fragmentShader;
<a name="l00606"></a>00606 
<a name="l00608"></a>00608         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00609"></a>00609 }
<a name="l00610"></a>00610 
<a name="l00611"></a>00611 <span class="comment">//----------------------------------------------------------</span>
<a name="l00612"></a>00612 <span class="keywordtype">void</span>
<a name="l00613"></a>00613 GrShader::Clean()
<a name="l00614"></a>00614 {
<a name="l00615"></a>00615         FreeShaders();
<a name="l00616"></a>00616         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; kMaxUserParams; ++i )
<a name="l00617"></a>00617         {
<a name="l00618"></a>00618                 _userParams[ i ].name = <span class="stringliteral">""</span>;
<a name="l00619"></a>00619                 <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; EGQ_COUNT; ++j )
<a name="l00620"></a>00620                         _userParams[ i ].UniformXfvARB[ j ] = 0;
<a name="l00621"></a>00621         }
<a name="l00622"></a>00622 
<a name="l00623"></a>00623         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; kMaxUserSamplers; ++i )
<a name="l00624"></a>00624         {
<a name="l00625"></a>00625                 _userSamplers[ i ].name = <span class="stringliteral">""</span>;
<a name="l00626"></a>00626                 _userSamplers[ i ].texUnit = 0;
<a name="l00627"></a>00627         }
<a name="l00628"></a>00628 }
<a name="l00629"></a>00629 
<a name="l00630"></a>00630 <span class="comment">//----------------------------------------------------------</span>
<a name="l00631"></a>00631 <span class="keywordtype">void</span>
<a name="l00632"></a>00632 GrShader::FreeShaders()
<a name="l00633"></a>00633 {
<a name="l00634"></a>00634         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; EGQ_COUNT; ++i )
<a name="l00635"></a>00635         {
<a name="l00636"></a>00636                 <span class="keywordflow">if</span> ( _glShaders[ i ] )
<a name="l00637"></a>00637                 {
<a name="l00639"></a>00639                         <a class="code" href="_g_l_subsys_8cpp.html#e730a287f86c5675b43e5bdf8be81032">bglDeleteProgram</a>( _glShaders[ i ] );
<a name="l00640"></a>00640                         <a class="code" href="_g_l_subsys_8cpp.html#9ab50de5f85395cba3f53a92df95c783">bglDeleteShader</a>( _glVertShaders[ i ] );
<a name="l00641"></a>00641                         <a class="code" href="_g_l_subsys_8cpp.html#9ab50de5f85395cba3f53a92df95c783">bglDeleteShader</a>( _glFragShaders[ i ] );
<a name="l00642"></a>00642 
<a name="l00644"></a>00644                         _glShaders[ i ] = 0;
<a name="l00645"></a>00645                         _glVertShaders[ i ] = 0;
<a name="l00646"></a>00646                         _glFragShaders[ i ] = 0;
<a name="l00647"></a>00647                 }
<a name="l00648"></a>00648         }
<a name="l00649"></a>00649 }
<a name="l00650"></a>00650 
<a name="l00651"></a>00651 <span class="comment">//----------------------------------------------------------</span>
<a name="l00652"></a>00652 <span class="keywordtype">bool</span>
<a name="l00653"></a>00653 GrShader::CompileShader( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="glext_8h.html#57b2a96adb1d51204909a82d861e395e">shader</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> strCount, <span class="keyword">const</span> <span class="keywordtype">char</span>** srcStrs, <a class="code" href="common__afx_8h.html#816fa58fd77499b0edb2c69ebe803d5c" title="include BootstrapFS.">tstring</a>&amp; errorMsg )
<a name="l00654"></a>00654 {
<a name="l00655"></a>00655         <span class="keywordtype">int</span> status = <a class="code" href="_g_l_8h.html#06316bc3c17db78ce93419fb208945ba">GL_TRUE</a>;
<a name="l00656"></a>00656         <a class="code" href="_g_l_subsys_8cpp.html#81f2c05c33b8406cbf1e22ae37621dcd">bglShaderSource</a>( shader, strCount, srcStrs, NULL );
<a name="l00657"></a>00657         <a class="code" href="_g_l_subsys_8cpp.html#0c311e9f79cd86ac14cef3384b789c7b">bglCompileShader</a>( shader );
<a name="l00658"></a>00658         <a class="code" href="_g_l_subsys_8cpp.html#e39a9a117ba8937805b4652fcfb6cbf9">bglGetShaderiv</a>( shader, <a class="code" href="glext_8h.html#8b14cf3c9445c50aabe5c7d21b31d215">GL_COMPILE_STATUS</a>, &amp;status );
<a name="l00659"></a>00659         <span class="keywordflow">if</span> ( status == <a class="code" href="_g_l_8h.html#bca6d43f43fae31f49dcb883b2f301f6">GL_FALSE</a> )
<a name="l00660"></a>00660         {
<a name="l00661"></a>00661                 GetShaderInfoLog( shader, errorMsg );
<a name="l00662"></a>00662                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00663"></a>00663         }
<a name="l00664"></a>00664         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00665"></a>00665 }
<a name="l00666"></a>00666 
<a name="l00667"></a>00667 <span class="comment">//----------------------------------------------------------</span>
<a name="l00668"></a>00668 <span class="keywordtype">void</span>
<a name="l00669"></a>00669 GrShader::GetShaderInfoLog( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> shader, <a class="code" href="common__afx_8h.html#816fa58fd77499b0edb2c69ebe803d5c" title="include BootstrapFS.">tstring</a>&amp; str )
<a name="l00670"></a>00670 {
<a name="l00671"></a>00671         <a class="code" href="_g_l_8h.html#9289d5b99dc1f27f01480360f2e18ae0">GLsizei</a> <a class="code" href="glext_8h.html#78c5c8710130a1a634d6a81d52be8db8">length</a> = 0;
<a name="l00672"></a>00672         <a class="code" href="_g_l_subsys_8cpp.html#e39a9a117ba8937805b4652fcfb6cbf9">bglGetShaderiv</a>( shader, <a class="code" href="glext_8h.html#e77c1e831fd164e9ac6c1a9cdb697ce5">GL_INFO_LOG_LENGTH</a>, &amp;length );
<a name="l00673"></a>00673         <span class="keywordtype">char</span>* infoLog = <span class="keyword">new</span> <span class="keywordtype">char</span>[ length + 1 ]; 
<a name="l00674"></a>00674         <a class="code" href="_g_l_subsys_8cpp.html#38da271fc299e553ecc4a4c1ab907764">bglGetShaderInfoLog</a>( shader, length+1, &amp;length, infoLog );
<a name="l00675"></a>00675         str = infoLog;
<a name="l00676"></a>00676         <span class="keyword">delete</span>[] infoLog;
<a name="l00677"></a>00677 }
<a name="l00678"></a>00678 
<a name="l00679"></a>00679 <span class="keywordtype">void</span>
<a name="l00680"></a>00680 GrShader::GetProgramInfoLog( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> program, <a class="code" href="common__afx_8h.html#816fa58fd77499b0edb2c69ebe803d5c" title="include BootstrapFS.">tstring</a>&amp; str )
<a name="l00681"></a>00681 {
<a name="l00682"></a>00682         <a class="code" href="_g_l_8h.html#9289d5b99dc1f27f01480360f2e18ae0">GLsizei</a> <a class="code" href="glext_8h.html#78c5c8710130a1a634d6a81d52be8db8">length</a> = 0;
<a name="l00683"></a>00683         <a class="code" href="_g_l_subsys_8cpp.html#10a0d7fb5af71d8198f925061445940a">bglGetProgramiv</a>( program, <a class="code" href="glext_8h.html#e77c1e831fd164e9ac6c1a9cdb697ce5">GL_INFO_LOG_LENGTH</a>, &amp;length );
<a name="l00684"></a>00684         <span class="keywordtype">char</span>* infoLog = <span class="keyword">new</span> <span class="keywordtype">char</span>[ length + 1 ]; 
<a name="l00685"></a>00685         <a class="code" href="_g_l_subsys_8cpp.html#29441d7bd44779fac644a483629154c9">bglGetProgramInfoLog</a>( program, length+1, &amp;length, infoLog );
<a name="l00686"></a>00686         str = infoLog;
<a name="l00687"></a>00687         <span class="keyword">delete</span>[] infoLog;
<a name="l00688"></a>00688 }
<a name="l00689"></a>00689 
<a name="l00690"></a>00690 <span class="comment">//----------------------------------------------------------</span>
<a name="l00691"></a>00691 <span class="keywordtype">void</span>
<a name="l00692"></a>00692 GrShader::InitEngineParam( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> quality, EPARAM <a class="code" href="glext_8h.html#f9d0cbbbeb7414e786c41899e5a856d7">target</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="glext_8h.html#f7477b8725fcf509c9623f64b9d09164">name</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> glType )
<a name="l00693"></a>00693 {
<a name="l00695"></a>00695         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( quality &lt; EGQ_COUNT &amp;&amp; target &lt; <a class="code" href="class_gr_shader.html#2f004c603bb97711d05eb68381a5a7ba5824c13eb2e93df0317ef2af40eabace">EP_COUNT</a> &amp;&amp; name != 0 );
<a name="l00696"></a>00696 
<a name="l00698"></a>00698         _engineParamHandles[ quality ][ target ] = <a class="code" href="_g_l_subsys_8cpp.html#bb18c184d3e9509103428fc528f25be1">bglGetUniformLocation</a>( _glShaders[ quality ], name );
<a name="l00699"></a>00699         <span class="keywordflow">if</span> ( _engineParamHandles[ quality ][ target ] != -1 )
<a name="l00700"></a>00700         {
<a name="l00702"></a>00702                 <a class="code" href="_g_l_8h.html#cebcc1c5663f14ebde1d16831e5fed94">GLint</a> uniformSize = 0;
<a name="l00703"></a>00703                 <a class="code" href="_g_l_8h.html#5d5233918a454ad3975c620a69ac5f0b">GLenum</a> <a class="code" href="_g_l_8h.html#7d05960f4f1c1b11f3177dc963a45d86">type</a> = 0;
<a name="l00704"></a>00704                 <span class="keywordtype">size_t</span> uniformNameLen = strlen( name ) + 1;
<a name="l00705"></a>00705                 <span class="keywordtype">char</span>* uniformName = ( <span class="keywordtype">char</span>* )alloca( uniformNameLen );
<a name="l00706"></a>00706                 <a class="code" href="_g_l_subsys_8cpp.html#7d3a0a299e53d4bf812e0cc61e0c2022">bglGetActiveUniform</a>( _glShaders[ quality ], _engineParamHandles[ quality ][ target ], ( <a class="code" href="_g_l_8h.html#9289d5b99dc1f27f01480360f2e18ae0">GLsizei</a> )uniformNameLen,
<a name="l00707"></a>00707                         NULL, &amp;uniformSize, &amp;type, uniformName );
<a name="l00708"></a>00708                 <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( uniformSize == 1 );
<a name="l00709"></a>00709                 <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( type == glType );
<a name="l00710"></a>00710                 <span class="keywordflow">if</span> ( type != glType )
<a name="l00711"></a>00711                         PostError( <span class="stringliteral">"Invalid engine parameter type specified for uniform %s!"</span>, name );
<a name="l00712"></a>00712 
<a name="l00713"></a>00713                 <span class="keywordflow">if</span> ( uniformSize != 1 )
<a name="l00714"></a>00714                         PostError( <span class="stringliteral">"Invalid uniform size encountered for uniform %s!"</span>, name );
<a name="l00715"></a>00715         }
<a name="l00716"></a>00716 
<a name="l00717"></a>00717         <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00718"></a>00718 }
<a name="l00719"></a>00719 
<a name="l00720"></a>00720 <span class="comment">//----------------------------------------------------------</span>
<a name="l00721"></a>00721 <span class="keywordtype">void</span>
<a name="l00722"></a>00722 GrShader::InitEngineSampler( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> quality, <span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> texUnit, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> glType )
<a name="l00723"></a>00723 {
<a name="l00725"></a>00725         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( quality &lt; EGQ_COUNT &amp;&amp; name != 0 );
<a name="l00726"></a>00726 
<a name="l00728"></a>00728         <span class="keywordtype">int</span> samplerLoc = <a class="code" href="_g_l_subsys_8cpp.html#bb18c184d3e9509103428fc528f25be1">bglGetUniformLocation</a>( _glShaders[ quality ], name );
<a name="l00729"></a>00729         <span class="keywordflow">if</span> ( samplerLoc != -1 )
<a name="l00730"></a>00730         {
<a name="l00732"></a>00732                 SetSamplerUsed( quality, texUnit );
<a name="l00733"></a>00733 
<a name="l00735"></a>00735                 <a class="code" href="_g_l_8h.html#cebcc1c5663f14ebde1d16831e5fed94">GLint</a> uniformSize = 0;
<a name="l00736"></a>00736                 <a class="code" href="_g_l_8h.html#5d5233918a454ad3975c620a69ac5f0b">GLenum</a> type = 0;
<a name="l00737"></a>00737                 <span class="keywordtype">size_t</span> uniformNameLen = strlen( name ) + 1;
<a name="l00738"></a>00738                 <span class="keywordtype">char</span>* uniformName = ( <span class="keywordtype">char</span>* )alloca( uniformNameLen );
<a name="l00739"></a>00739                 <a class="code" href="_g_l_subsys_8cpp.html#7d3a0a299e53d4bf812e0cc61e0c2022">bglGetActiveUniform</a>( _glShaders[ quality ], samplerLoc, ( <a class="code" href="_g_l_8h.html#9289d5b99dc1f27f01480360f2e18ae0">GLsizei</a> )uniformNameLen,
<a name="l00740"></a>00740                         NULL, &amp;uniformSize, &amp;type, uniformName );
<a name="l00741"></a>00741                 <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( uniformSize == 1 );
<a name="l00742"></a>00742                 <span class="keywordflow">if</span> ( type != glType )
<a name="l00743"></a>00743                 {
<a name="l00745"></a>00745                         <span class="keywordflow">if</span> ( glType != <a class="code" href="glext_8h.html#166645e482b60d35b1d31c2f6f378238">GL_SAMPLER_2D</a> &amp;&amp; type != <a class="code" href="glext_8h.html#75c4dbe7bfc18f7a44bd6211fa868bb7">GL_SAMPLER_2D_SHADOW_ARB</a> &amp;&amp;
<a name="l00746"></a>00746                                  glType != <a class="code" href="glext_8h.html#ad6df9e9229dd5b3d827b329ecfd3a1d">GL_SAMPLER_2D_RECT_ARB</a> &amp;&amp; type != <a class="code" href="glext_8h.html#c6276cc957c6eb10cf6d6cd528acf1c6">GL_SAMPLER_2D_RECT_SHADOW_ARB</a> )
<a name="l00747"></a>00747                                 PostError( <span class="stringliteral">"Invalid engine sampler type specified for uniform %s!"</span>, name );
<a name="l00748"></a>00748                 }
<a name="l00749"></a>00749 
<a name="l00750"></a>00750                 <span class="keywordflow">if</span> ( uniformSize != 1 )
<a name="l00751"></a>00751                         PostError( <span class="stringliteral">"Invalid uniform size encountered for uniform %s!"</span>, name );
<a name="l00752"></a>00752 
<a name="l00755"></a>00755                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> prevShader = <a class="code" href="_gr_util_8cpp.html#cf8fae2ee0807b48ac9c5bdb8ae47583">GrGetShader</a>();
<a name="l00756"></a>00756 
<a name="l00758"></a>00758                 <a class="code" href="_gr_util_8cpp.html#a40f94ecd4645027260b3217ce172cbe">GrBindShader</a>( _glShaders[ quality ] );
<a name="l00759"></a>00759                 <a class="code" href="_g_l_subsys_8cpp.html#89c73d9b863fe16d54d6a5154586c1a9">bglUniform1i</a>( samplerLoc, texUnit );
<a name="l00760"></a>00760 
<a name="l00762"></a>00762                 <a class="code" href="_gr_util_8cpp.html#a40f94ecd4645027260b3217ce172cbe">GrBindShader</a>( prevShader );
<a name="l00763"></a>00763                 <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00764"></a>00764         }
<a name="l00765"></a>00765 }
<a name="l00766"></a>00766 
<a name="l00767"></a>00767 <span class="comment">//----------------------------------------------------------</span>
<a name="l00768"></a>00768 <span class="keywordtype">void</span>
<a name="l00769"></a>00769 GrShader::PostError( <span class="keyword">const</span> <span class="keywordtype">char</span>* fmt, ... )
<a name="l00770"></a>00770 {
<a name="l00772"></a>00772         va_list args;
<a name="l00773"></a>00773         va_start( args, fmt );
<a name="l00774"></a>00774 <span class="preprocessor">#ifdef _MSC_VER</span>
<a name="l00775"></a>00775 <span class="preprocessor"></span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="glext_8h.html#2ba89f9e8d669bfad57028ce780865cd">len</a> = _vscprintf( fmt, args ) + 1;
<a name="l00776"></a>00776         <span class="keywordtype">char</span>* <a class="code" href="_u_t_message_8h.html#e28c9430ba2b97dabdc5ca98ff772987">buf</a> = <span class="keyword">new</span> <span class="keywordtype">char</span>[ len ];
<a name="l00777"></a>00777         vsprintf_s( buf, len, fmt, args );
<a name="l00778"></a>00778 <span class="preprocessor">#else</span>
<a name="l00780"></a>00780 <span class="preprocessor">        //char *buf = ( char * )alloca( 1 );</span>
<a name="l00781"></a>00781 <span class="preprocessor"></span>        <span class="comment">//int bufSize = vsnprintf( buf, 1, fmt, args );</span>
<a name="l00783"></a>00783 <span class="comment"></span>        <span class="comment">//va_end( args );</span>
<a name="l00784"></a>00784         <span class="comment">//va_start( args, fmt );</span>
<a name="l00785"></a>00785         <span class="comment">//buf = new char[ bufSize + 1 ];</span>
<a name="l00786"></a>00786         <span class="comment">//vsnprintf( buf, bufSize+1, fmt, args );</span>
<a name="l00787"></a>00787         <span class="comment">//va_end( args );</span>
<a name="l00788"></a>00788         <a class="code" href="common__afx_8h.html#816fa58fd77499b0edb2c69ebe803d5c" title="include BootstrapFS.">tstring</a> temp;
<a name="l00789"></a>00789         <a class="code" href="common__afx_8cpp.html#c415616c8d5f1df71308de030ffafe10" title="exceptions disabled!">VSPrintF</a>( temp, fmt, args );
<a name="l00790"></a>00790         <span class="keyword">const</span> <span class="keywordtype">char</span> *buf = temp.c_str();
<a name="l00791"></a>00791 <span class="preprocessor">#endif</span>
<a name="l00792"></a>00792 <span class="preprocessor"></span>        va_end( args );
<a name="l00793"></a>00793 
<a name="l00795"></a>00795         <a class="code" href="common__afx_8h.html#816fa58fd77499b0edb2c69ebe803d5c" title="include BootstrapFS.">tstring</a> errorMsg = <span class="stringliteral">"Error in shader '"</span>;
<a name="l00796"></a>00796         errorMsg += _name.<a class="code" href="class_u_path.html#970648bc09145c6da1712022d84ad3b7" title="returns the path string.">GetPathString</a>();
<a name="l00797"></a>00797         errorMsg += <span class="stringliteral">"'...\n\n"</span>;
<a name="l00798"></a>00798         errorMsg += buf;
<a name="l00799"></a>00799 
<a name="l00801"></a>00801         <span class="keyword">delete</span> buf;
<a name="l00802"></a>00802 
<a name="l00803"></a>00803         <a class="code" href="common__afx_8cpp.html#f1a1e0f08b49000974368246e5b97f84" title="debug output/console output function.">PrintF</a>( errorMsg.c_str() );
<a name="l00804"></a>00804 
<a name="l00806"></a>00806         <a class="code" href="common__afx_8h.html#b7017537090be31ed41b17e6d25330d6">B_ERROR</a>( errorMsg.c_str() );
<a name="l00807"></a>00807 }
<a name="l00808"></a>00808 
<a name="l00809"></a>00809 <span class="comment">//----------------------------------------------------------</span>
<a name="l00810"></a>00810 <span class="keywordtype">bool</span>
<a name="l00811"></a>00811 GrShader::GetUserParamInfo( SUserParam* <a class="code" href="glext_8h.html#c7c896d55e93a6cf7ff8524005b4e7b4">param</a> )
<a name="l00812"></a>00812 {
<a name="l00813"></a>00813         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( param != 0 );
<a name="l00814"></a>00814 
<a name="l00815"></a>00815         <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;
<a name="l00816"></a>00816         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; EGQ_COUNT; ++i )
<a name="l00817"></a>00817         {
<a name="l00819"></a>00819                 param-&gt;handles[ i ] = <a class="code" href="_g_l_subsys_8cpp.html#bb18c184d3e9509103428fc528f25be1">bglGetUniformLocation</a>( _glShaders[ i ], param-&gt;name.c_str() );
<a name="l00820"></a>00820                 <span class="keywordflow">if</span> ( param-&gt;handles[ i ] != ~0 )
<a name="l00821"></a>00821                 {
<a name="l00822"></a>00822                         found = <span class="keyword">true</span>;
<a name="l00823"></a>00823                         <span class="keyword">static</span> <span class="keywordtype">char</span> nothing[1] = {0};
<a name="l00824"></a>00824                         <span class="keywordtype">int</span> <a class="code" href="glext_8h.html#3d1e3edfcf61ca2d831883e1afbad89e">size</a> = 0;
<a name="l00825"></a>00825                         <a class="code" href="_g_l_8h.html#5d5233918a454ad3975c620a69ac5f0b">GLenum</a> type = 0;
<a name="l00826"></a>00826                         <a class="code" href="_g_l_subsys_8cpp.html#7d3a0a299e53d4bf812e0cc61e0c2022">bglGetActiveUniform</a>( _glShaders[ i ], param-&gt;handles[ i ], 0, 0, &amp;size, &amp;type,
<a name="l00827"></a>00827                                 nothing );
<a name="l00828"></a>00828                         <span class="keywordflow">if</span> ( size &gt; 1 )
<a name="l00829"></a>00829                         {
<a name="l00830"></a>00830                                 <a class="code" href="common__afx_8cpp.html#f1a1e0f08b49000974368246e5b97f84" title="debug output/console output function.">PrintF</a>( <span class="stringliteral">"Warning: Array specified as shader parameter in shader '%s'; only array element 0 is accessible.\n"</span>,
<a name="l00831"></a>00831                                         _name.<a class="code" href="class_u_path.html#970648bc09145c6da1712022d84ad3b7" title="returns the path string.">GetPathString</a>().c_str() );
<a name="l00832"></a>00832                         }
<a name="l00833"></a>00833 
<a name="l00835"></a>00835                         <span class="keywordflow">switch</span> ( type )
<a name="l00836"></a>00836                         {
<a name="l00837"></a>00837                         <span class="keywordflow">case</span> <a class="code" href="_g_l_8h.html#6d19915d4237cb559505bd3e5dcfcf3c">GL_FLOAT</a>:
<a name="l00838"></a>00838                                 param-&gt;UniformXfvARB[ i ] = <a class="code" href="_g_l_subsys_8cpp.html#985caea1e1b72d7bb51dc1c5632ce891">bglUniform1fv</a>;
<a name="l00839"></a>00839                                 <span class="keywordflow">break</span>;
<a name="l00840"></a>00840                         <span class="keywordflow">case</span> <a class="code" href="glext_8h.html#5a915785c9c1384397508f85023c1a8d">GL_FLOAT_VEC2_ARB</a>:
<a name="l00841"></a>00841                                 param-&gt;UniformXfvARB[ i ] = <a class="code" href="_g_l_subsys_8cpp.html#348109bdd1707ef8b70fb1d4d2dbd853">bglUniform2fv</a>;
<a name="l00842"></a>00842                                 <span class="keywordflow">break</span>;
<a name="l00843"></a>00843                         <span class="keywordflow">case</span> <a class="code" href="glext_8h.html#e006c284df5b4e1c8690407157c255d5">GL_FLOAT_VEC3_ARB</a>:
<a name="l00844"></a>00844                                 param-&gt;UniformXfvARB[ i ] = <a class="code" href="_g_l_subsys_8cpp.html#688d4260dc3d35093533d17cf3608221">bglUniform3fv</a>;
<a name="l00845"></a>00845                                 <span class="keywordflow">break</span>;
<a name="l00846"></a>00846                         <span class="keywordflow">case</span> <a class="code" href="glext_8h.html#696cfaceb3256bf19e990e46702fe527">GL_FLOAT_VEC4</a>:
<a name="l00847"></a>00847                                 param-&gt;UniformXfvARB[ i ] = <a class="code" href="_g_l_subsys_8cpp.html#4e9f22d939346ae7259124ded3a7fa69">bglUniform4fv</a>;
<a name="l00848"></a>00848                                 <span class="keywordflow">break</span>;
<a name="l00849"></a>00849                         };
<a name="l00850"></a>00850                 }
<a name="l00851"></a>00851         }
<a name="l00852"></a>00852         <span class="keywordflow">return</span> found;
<a name="l00853"></a>00853 }
<a name="l00854"></a>00854 
<a name="l00855"></a>00855 <span class="comment">//----------------------------------------------------------</span>
<a name="l00856"></a>00856 <span class="keywordtype">void</span>
<a name="l00857"></a>00857 GrShader::SetUserSamplerUniform( <span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> texUnit )
<a name="l00858"></a>00858 {
<a name="l00860"></a>00860         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> prevShader = <a class="code" href="_gr_util_8cpp.html#cf8fae2ee0807b48ac9c5bdb8ae47583">GrGetShader</a>();
<a name="l00861"></a>00861         <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00862"></a>00862 
<a name="l00864"></a>00864         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; EGQ_COUNT; ++i )
<a name="l00865"></a>00865         {
<a name="l00866"></a>00866                 <span class="keywordtype">int</span> paramLoc = <a class="code" href="_g_l_subsys_8cpp.html#bb18c184d3e9509103428fc528f25be1">bglGetUniformLocation</a>( _glShaders[ i ], name );
<a name="l00867"></a>00867                 <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00868"></a>00868                 <span class="keywordflow">if</span> ( paramLoc == -1 )
<a name="l00869"></a>00869                         <span class="keywordflow">continue</span>;
<a name="l00870"></a>00870                 <a class="code" href="_gr_util_8cpp.html#a40f94ecd4645027260b3217ce172cbe">GrBindShader</a>( _glShaders[ i ] );
<a name="l00871"></a>00871                 <a class="code" href="_g_l_subsys_8cpp.html#89c73d9b863fe16d54d6a5154586c1a9">bglUniform1i</a>( paramLoc, texUnit );
<a name="l00872"></a>00872                 <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00873"></a>00873         }
<a name="l00874"></a>00874 
<a name="l00876"></a>00876         <a class="code" href="_gr_util_8cpp.html#a40f94ecd4645027260b3217ce172cbe">GrBindShader</a>( prevShader );
<a name="l00877"></a>00877         <a class="code" href="_g_l_subsys_8h.html#ab12f88c1ad74a5b4876f37fcf105bda">CHECK_GL</a>();
<a name="l00878"></a>00878 }
<a name="l00879"></a>00879 
<a name="l00880"></a>00880 <span class="comment">//----------------------------------------------------------</span>
<a name="l00881"></a>00881 <span class="keywordtype">void</span>
<a name="l00882"></a>00882 GrShader::SetSamplerUsed( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> quality, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> texUnit )
<a name="l00883"></a>00883 {
<a name="l00884"></a>00884         _samplersUsed[ quality ] |= ( 1 &lt;&lt; texUnit );
<a name="l00885"></a>00885 }
<a name="l00886"></a>00886 
<a name="l00887"></a>00887 <span class="comment">//----------------------------------------------------------</span>
<a name="l00888"></a>00888 <span class="keywordtype">void</span>
<a name="l00889"></a>00889 <a class="code" href="class_gr_shader.html#420e8f1956844878d2a8aeb09f0ab888">GrShader::Validate</a>( <a class="code" href="enums_8h.html#697c1ee1354746841860d5bf9f81c033" title="standard quality enum">EGRQUALITY</a> quality )
<a name="l00890"></a>00890 {
<a name="l00892"></a>00892         <span class="keywordtype">int</span> status = <a class="code" href="_g_l_8h.html#06316bc3c17db78ce93419fb208945ba">GL_TRUE</a>;
<a name="l00893"></a>00893         <span class="keywordflow">if</span> ( !_needValidate[ quality ] )
<a name="l00894"></a>00894                 <span class="keywordflow">return</span>;
<a name="l00895"></a>00895 
<a name="l00897"></a>00897         <a class="code" href="_g_l_subsys_8cpp.html#8efdcdbeca7e585a6844c32ff862b72b">bglValidateProgram</a>( _glShaders[ quality ] );
<a name="l00898"></a>00898         <a class="code" href="_g_l_subsys_8cpp.html#10a0d7fb5af71d8198f925061445940a">bglGetProgramiv</a>( _glShaders[ quality ], <a class="code" href="glext_8h.html#24b642fbcaffb55c9131a1e7d981e9cc">GL_VALIDATE_STATUS</a>, &amp;status );
<a name="l00899"></a>00899         <span class="keywordflow">if</span> ( status == <a class="code" href="_g_l_8h.html#bca6d43f43fae31f49dcb883b2f301f6">GL_FALSE</a> )
<a name="l00900"></a>00900         {
<a name="l00901"></a>00901                 <a class="code" href="common__afx_8h.html#816fa58fd77499b0edb2c69ebe803d5c" title="include BootstrapFS.">tstring</a> errorMsg;
<a name="l00902"></a>00902                 GetProgramInfoLog( _glShaders[ quality ], errorMsg );
<a name="l00903"></a>00903                 PostError( <span class="stringliteral">"Error validating shader...\n%s"</span>, errorMsg.c_str() );
<a name="l00904"></a>00904         }
<a name="l00905"></a>00905         <span class="keywordflow">else</span>
<a name="l00906"></a>00906         {
<a name="l00908"></a>00908                 _needValidate[ quality ] = <span class="keyword">false</span>;
<a name="l00909"></a>00909         }
<a name="l00910"></a>00910 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Feb 13 17:19:58 2009 for Bootstrap Engine by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
