<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Bootstrap Engine: C:/Bootstrap/ProjectBX/Documentation/Code/Engine/UberTexture/UTClient.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>C:/Bootstrap/ProjectBX/Documentation/Code/Engine/UberTexture/UTClient.cpp File Reference</h1><code>#include &quot;<a class="el" href="ubertexture__afx_8h-source.html">ubertexture_afx.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="_u_t_client_8h-source.html">UTClient.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="_u_t_net_utils_8h-source.html">UTNetUtils.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="_u_t_config_8h-source.html">UTConfig.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="_u_t_message_8h-source.html">UTMessage.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="common__afx_8h-source.html">common_afx.h</a>&quot;</code><br>
<code>#include &lt;windows.h&gt;</code><br>
<code>#include &lt;winsock.h&gt;</code><br>
<code>#include &lt;mmsystem.h&gt;</code><br>

<p>
<a href="_u_t_client_8cpp-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_u_t_client_8cpp.html#912c4d08b68350084d23c235e3ad98a6">SafeCloseHandle</a>(<a class="el" href="wglext_8h.html#d77deca22f617d3f0e0eb786445689fc">x</a>)&nbsp;&nbsp;&nbsp;{ if ( <a class="el" href="wglext_8h.html#d77deca22f617d3f0e0eb786445689fc">x</a> ) { CloseHandle( <a class="el" href="wglext_8h.html#d77deca22f617d3f0e0eb786445689fc">x</a> ); <a class="el" href="wglext_8h.html#d77deca22f617d3f0e0eb786445689fc">x</a> = 0; } }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">file header.  <a href="#912c4d08b68350084d23c235e3ad98a6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_u_t_client_8cpp.html#142810068f1b99cd93d3fc9f0e160e02">QUEUE_SIZE</a>&nbsp;&nbsp;&nbsp;64</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_u_t_client_8cpp.html#caf975981331f018f9daf89d313fb0d1">SEND_BUFFER_SIZE</a>&nbsp;&nbsp;&nbsp;1048576</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_u_t_client_8cpp.html#a85d61320a872e888a8d65610f963ee6">UTClientConnect</a> (const char *<a class="el" href="glext__bak_8h.html#86e3d190561a4ae1e195e1a2bcc83db5">address</a>, unsigned short port)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Global functions.  <a href="#a85d61320a872e888a8d65610f963ee6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_u_t_client_8cpp.html#8822ec1f29f974a5267f154062b92ad3">UTClientDisconnect</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">UTDisconnect: disconnects from the server. Returns true on success.  <a href="#8822ec1f29f974a5267f154062b92ad3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct_u_t__message__t.html">UT_message_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_u_t_client_8cpp.html#37332b817546142d064d5f7de3e350e9">UTClientQueueOutgoing</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct_u_t__message__t.html">UT_message_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_u_t_client_8cpp.html#11727626642e61e2bbeecb0bb91d8e8a">UTClientRemoveIncoming</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_u_t_client_8cpp.html#3f04aee81822bf61153073fcfb91a78c">UTClientOutgoingCount</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_u_t_client_8cpp.html#dffaf42400fd71727e0eac14ac18d1c7">UTClientIncomingCount</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_u_t_client_8cpp.html#830a9157ed60ab0a645174b61c209ed5">UTSyncToResponse</a> (unsigned int transactionId, unsigned int timeToWait)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_u_t_client_8cpp.html#e040d3e1e944d062ccad7f318bdab973">UTClientUpdateQueues</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">UTClientUpdateQueues: updates the incoming and outgoing message queues.  <a href="#e040d3e1e944d062ccad7f318bdab973"></a><br></td></tr>
</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="142810068f1b99cd93d3fc9f0e160e02"></a><!-- doxytag: member="UTClient.cpp::QUEUE_SIZE" ref="142810068f1b99cd93d3fc9f0e160e02" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define QUEUE_SIZE&nbsp;&nbsp;&nbsp;64          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="_u_t_client_8cpp-source.html#l00025">25</a> of file <a class="el" href="_u_t_client_8cpp-source.html">UTClient.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="912c4d08b68350084d23c235e3ad98a6"></a><!-- doxytag: member="UTClient.cpp::SafeCloseHandle" ref="912c4d08b68350084d23c235e3ad98a6" args="(x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SafeCloseHandle          </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="wglext_8h.html#d77deca22f617d3f0e0eb786445689fc">x</a>&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;{ if ( <a class="el" href="wglext_8h.html#d77deca22f617d3f0e0eb786445689fc">x</a> ) { CloseHandle( <a class="el" href="wglext_8h.html#d77deca22f617d3f0e0eb786445689fc">x</a> ); <a class="el" href="wglext_8h.html#d77deca22f617d3f0e0eb786445689fc">x</a> = 0; } }</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
file header. 
<p>
File: <a class="el" href="_u_t_client_8cpp.html">UTClient.cpp</a> Author: Kevin Bray Created: 11-23-07 Copyright © 2004 Bootstrap Studios. All rights reserved. project includes. windows includes. 
<p>Definition at line <a class="el" href="_u_t_client_8cpp-source.html#l00023">23</a> of file <a class="el" href="_u_t_client_8cpp-source.html">UTClient.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="caf975981331f018f9daf89d313fb0d1"></a><!-- doxytag: member="UTClient.cpp::SEND_BUFFER_SIZE" ref="caf975981331f018f9daf89d313fb0d1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEND_BUFFER_SIZE&nbsp;&nbsp;&nbsp;1048576          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="_u_t_client_8cpp-source.html#l00026">26</a> of file <a class="el" href="_u_t_client_8cpp-source.html">UTClient.cpp</a>.</p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a85d61320a872e888a8d65610f963ee6"></a><!-- doxytag: member="UTClient.cpp::UTClientConnect" ref="a85d61320a872e888a8d65610f963ee6" args="(const char *address, unsigned short port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool UTClientConnect           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&nbsp;</td>
          <td class="paramname"> <em>port</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Global functions. 
<p>
UTConnect: connects to the UberTexture server at the ip-address specified. Returns true on success. 
<p>
make sure we haven't already been connected!<p>
make sure winsock is running.<p>
create the socket.<p>
set to localhost if needed.<p>
make the socket address.<p>
get the host from a name.<p>
make the socket address.<p>
create the socket from an IP address.<p>
try to connect to the address.<p>
figure out whether or not we're connecting to this machine.<p>
allocate the handshake buffer.<p>
select the proper handshake message.<p>
send the handshake message.<p>
is the connection local or not?<p>
if we're local, receive 4 bytes. That is the length of the named buffer.<p>
now receive the name of the shared buffer.<p>
try to open the shared memory.<p>
try to map the memory.<p>
set the send and receive buffer pointers.<p>
get the server mutex.<p>
set the send/receive procedures to use winsock.<p>
get the accept message.<p>
make sure the handshake was valid!<p>
set the send/receive procedures to use winsock.<p>
make the socket async.<p>
make the socket non-buffered.<p>
initialize the FIFOs.<p>
initialize the send buffer.<p>
return true to indicate success. 
<p>Definition at line <a class="el" href="_u_t_client_8cpp-source.html#l00060">60</a> of file <a class="el" href="_u_t_client_8cpp-source.html">UTClient.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="8822ec1f29f974a5267f154062b92ad3"></a><!-- doxytag: member="UTClient.cpp::UTClientDisconnect" ref="8822ec1f29f974a5267f154062b92ad3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool UTClientDisconnect           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
UTDisconnect: disconnects from the server. Returns true on success. 
<p>

<p>
free the send buffer.<p>
close mutex handles.<p>
do we need to release our shared buffer?<p>
unmap the view of the file.<p>
clear our shared memory file mapping values.<p>
if we're not connected, return failure.<p>
close our socket.<p>
set the socet to the invalid-socket value.<p>
call cleanup to make sure that winsock is shutdown properly.<p>
return true to indicate success. 
<p>Definition at line <a class="el" href="_u_t_client_8cpp-source.html#l00256">256</a> of file <a class="el" href="_u_t_client_8cpp-source.html">UTClient.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="dffaf42400fd71727e0eac14ac18d1c7"></a><!-- doxytag: member="UTClient.cpp::UTClientIncomingCount" ref="dffaf42400fd71727e0eac14ac18d1c7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t UTClientIncomingCount           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
UTClientIncomingCount: returns the number of queued messages in the incoming queue. 
<p>Definition at line <a class="el" href="_u_t_client_8cpp-source.html#l00332">332</a> of file <a class="el" href="_u_t_client_8cpp-source.html">UTClient.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="3f04aee81822bf61153073fcfb91a78c"></a><!-- doxytag: member="UTClient.cpp::UTClientOutgoingCount" ref="3f04aee81822bf61153073fcfb91a78c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t UTClientOutgoingCount           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
UTClientOutgoingCount: returns the number of queued messages in the outgoing queue. 
<p>Definition at line <a class="el" href="_u_t_client_8cpp-source.html#l00326">326</a> of file <a class="el" href="_u_t_client_8cpp-source.html">UTClient.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="37332b817546142d064d5f7de3e350e9"></a><!-- doxytag: member="UTClient.cpp::UTClientQueueOutgoing" ref="37332b817546142d064d5f7de3e350e9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_u_t__message__t.html">UT_message_t</a>* UTClientQueueOutgoing           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
UTClientQueueOutgoing: queue an outgoing message in the outgoing message queue. 
<p>
return the new message. 
<p>Definition at line <a class="el" href="_u_t_client_8cpp-source.html#l00304">304</a> of file <a class="el" href="_u_t_client_8cpp-source.html">UTClient.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="11727626642e61e2bbeecb0bb91d8e8a"></a><!-- doxytag: member="UTClient.cpp::UTClientRemoveIncoming" ref="11727626642e61e2bbeecb0bb91d8e8a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_u_t__message__t.html">UT_message_t</a>* UTClientRemoveIncoming           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
UTClientRemoveIncoming: remove an incoming message in the incoming message queue. 
<p>
get the message and verify that it's ready.<p>
return the incoming message.<p>
no message is ready. 
<p>Definition at line <a class="el" href="_u_t_client_8cpp-source.html#l00311">311</a> of file <a class="el" href="_u_t_client_8cpp-source.html">UTClient.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="e040d3e1e944d062ccad7f318bdab973"></a><!-- doxytag: member="UTClient.cpp::UTClientUpdateQueues" ref="e040d3e1e944d062ccad7f318bdab973" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UTClientUpdateQueues           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
UTClientUpdateQueues: updates the incoming and outgoing message queues. 
<p>

<p>
send all queued messages.<p>
recv incoming messages. 
<p>Definition at line <a class="el" href="_u_t_client_8cpp-source.html#l00368">368</a> of file <a class="el" href="_u_t_client_8cpp-source.html">UTClient.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="830a9157ed60ab0a645174b61c209ed5"></a><!-- doxytag: member="UTClient.cpp::UTSyncToResponse" ref="830a9157ed60ab0a645174b61c209ed5" args="(unsigned int transactionId, unsigned int timeToWait)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool UTSyncToResponse           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>transactionId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>timeToWait</em> = <code>1000</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
SyncToResponse: synchronizes to the response of the transaction ID passed in. This function returns true on success, false on failure. If this function returns true, then the reply to the message is waiting in the message queue. 
<p>
spin-lock until we hit a response to the transaction ID passed in.<p>
check to see if the incoming message queue is full. If so, return false to indicate failure.<p>
update the queues so we can process incoming messages.<p>
get the top of the message queue.<p>
check to see if we need to time-out.<p>
return true to indicate success. 
<p>Definition at line <a class="el" href="_u_t_client_8cpp-source.html#l00338">338</a> of file <a class="el" href="_u_t_client_8cpp-source.html">UTClient.cpp</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Feb 13 17:20:04 2009 for Bootstrap Engine by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
