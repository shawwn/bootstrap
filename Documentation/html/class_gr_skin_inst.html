<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Bootstrap Engine: GrSkinInst Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>GrSkinInst Class Reference</h1><!-- doxytag: class="GrSkinInst" -->class <a class="el" href="class_gr_skin.html" title="class GrSkin">GrSkin</a>  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="_gr_skin_inst_8h-source.html">GrSkinInst.h</a>&gt;</code>
<p>

<p>
<a href="class_gr_skin_inst-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_skin_inst.html#97aaf25b3f26c18e5ad7032d74e57f40">GrSkinInst</a> (<a class="el" href="class_gr_mesh_inst.html">GrMeshInst</a> *targetMeshInst)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">the skin takes over the pointers passed in.  <a href="#97aaf25b3f26c18e5ad7032d74e57f40"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_skin_inst.html#a74804ebf0e656cc67c4d4722eaf23ef">~GrSkinInst</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_gr_skin.html">GrSkin</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_skin_inst.html#d1ba05944156fe4f5a402c554e35b21b">GetSkin</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">returns the skin.  <a href="#d1ba05944156fe4f5a402c554e35b21b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_skin_inst.html#d4d83abff901eccff4500f217c6af8a9">Pick</a> (<a class="el" href="class_u_fast_array.html">GrMesh::TriHitArray</a> &amp;triHits, const <a class="el" href="class_m_ray.html">MRay</a> &amp;ray) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">picks against the animated mesh.  <a href="#d4d83abff901eccff4500f217c6af8a9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_skin_inst.html#cf78011014e52a7f8b14fe00a83b7151">GetBoneCount</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">bone management.  <a href="#cf78011014e52a7f8b14fe00a83b7151"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const <a class="el" href="common__afx_8h.html#816fa58fd77499b0edb2c69ebe803d5c">tstring</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_skin_inst.html#1fce790a944bbf468dacc975b7b020c8">GetBoneName</a> (unsigned int <a class="el" href="glext__bak_8h.html#58c2a664503e14ffb8f21012aabff3e9">id</a>) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_skin_inst.html#a2fc77f57e5873e8967452d9c4359d43">GetBoneId</a> (const char *<a class="el" href="glext__bak_8h.html#bb62efe59ccdd153ce42e1a418352209">name</a>) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_skin_inst.html#c87444515796dea8b8e939cc43434655">SetBoneMatrix</a> (unsigned int boneId, const <a class="el" href="class_m_mat4x4.html">MMat4x4</a> &amp;<a class="el" href="glext__bak_8h.html#7b24a3f2f56eb1244ae69dacb4fecb6f">matrix</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_skin_inst.html#26a87eb455330a647709378ca51f3d52">ApplySkin</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">skin the mesh.  <a href="#26a87eb455330a647709378ca51f3d52"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
class <a class="el" href="class_gr_skin.html" title="class GrSkin">GrSkin</a> 
<p>Definition at line <a class="el" href="_gr_skin_inst_8h-source.html#l00028">28</a> of file <a class="el" href="_gr_skin_inst_8h-source.html">GrSkinInst.h</a>.</p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="97aaf25b3f26c18e5ad7032d74e57f40"></a><!-- doxytag: member="GrSkinInst::GrSkinInst" ref="97aaf25b3f26c18e5ad7032d74e57f40" args="(GrMeshInst *targetMeshInst)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GrSkinInst::GrSkinInst           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_gr_mesh_inst.html">GrMeshInst</a> *&nbsp;</td>
          <td class="paramname"> <em>targetMeshInst</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
the skin takes over the pointers passed in. 
<p>
class <a class="el" href="class_gr_skin_inst.html" title="class GrSkin">GrSkinInst</a><p>
ctor &amp; dtor 
<p>
ensure that a valid mesh was passed in!<p>
store the target mesh and skin data.<p>
ensure that the mesh passed in is skinned!<p>
ensure that the skinning information is valid.<p>
invert all of the modelToBone matrices as they're currently set to their bind pose (bone-&gt;model... we want model-&gt;bone). 
<p>Definition at line <a class="el" href="_gr_skin_inst_8cpp-source.html#l00040">40</a> of file <a class="el" href="_gr_skin_inst_8cpp-source.html">GrSkinInst.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="a74804ebf0e656cc67c4d4722eaf23ef"></a><!-- doxytag: member="GrSkinInst::~GrSkinInst" ref="a74804ebf0e656cc67c4d4722eaf23ef" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GrSkinInst::~GrSkinInst           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="_gr_skin_inst_8cpp-source.html#l00074">74</a> of file <a class="el" href="_gr_skin_inst_8cpp-source.html">GrSkinInst.cpp</a>.</p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="26a87eb455330a647709378ca51f3d52"></a><!-- doxytag: member="GrSkinInst::ApplySkin" ref="26a87eb455330a647709378ca51f3d52" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GrSkinInst::ApplySkin           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
skin the mesh. 
<p>

<p>
update our bone matrices if needed.<p>
update our bone matrices by concatenating the inverse bind pose matrix and the animated bone matrices. This has the effect of moving vertices into bone space, then animating them back into model space.<p>
calculate the matrix for animating the vertex position.<p>
calculate the matrix for rotating the tangent space basis.<p>
we're no longer dirty, so clear the dirty flag.<p>
min/max of skinned vertices<p>
get source vertex data.<p>
get target vertex data.<p>
get vertex bone ids/weights.<p>
skin.<p>
calculate positional bone influences. bone 0.<p>
bone 1.<p>
bone 2.<p>
take the min/max for each vertex to calculate a new AA box.<p>
copy to the destination vertex.<p>
calculate tangent space basis bone influences.<p>
bone 0.<p>
bone 1.<p>
bone 2.<p>
normalize.<p>
copy to the destination TSB vector.<p>
next TSB vector.<p>
next vertex data.<p>
flag mesh components as dirty. 
<p>Definition at line <a class="el" href="_gr_skin_inst_8cpp-source.html#l00136">136</a> of file <a class="el" href="_gr_skin_inst_8cpp-source.html">GrSkinInst.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="cf78011014e52a7f8b14fe00a83b7151"></a><!-- doxytag: member="GrSkinInst::GetBoneCount" ref="cf78011014e52a7f8b14fe00a83b7151" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int GrSkinInst::GetBoneCount           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
bone management. 
<p>

<p>Definition at line <a class="el" href="_gr_skin_inst_8cpp-source.html#l00095">95</a> of file <a class="el" href="_gr_skin_inst_8cpp-source.html">GrSkinInst.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="a2fc77f57e5873e8967452d9c4359d43"></a><!-- doxytag: member="GrSkinInst::GetBoneId" ref="a2fc77f57e5873e8967452d9c4359d43" args="(const char *name) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int GrSkinInst::GetBoneId           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="_gr_skin_inst_8cpp-source.html#l00111">111</a> of file <a class="el" href="_gr_skin_inst_8cpp-source.html">GrSkinInst.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="1fce790a944bbf468dacc975b7b020c8"></a><!-- doxytag: member="GrSkinInst::GetBoneName" ref="1fce790a944bbf468dacc975b7b020c8" args="(unsigned int id) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="common__afx_8h.html#816fa58fd77499b0edb2c69ebe803d5c">tstring</a> &amp; GrSkinInst::GetBoneName           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>id</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="_gr_skin_inst_8cpp-source.html#l00103">103</a> of file <a class="el" href="_gr_skin_inst_8cpp-source.html">GrSkinInst.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="d1ba05944156fe4f5a402c554e35b21b"></a><!-- doxytag: member="GrSkinInst::GetSkin" ref="d1ba05944156fe4f5a402c554e35b21b" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_gr_skin.html">GrSkin</a>* GrSkinInst::GetSkin           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
returns the skin. 
<p>

<p>Definition at line <a class="el" href="_gr_skin_inst_8h-source.html#l00036">36</a> of file <a class="el" href="_gr_skin_inst_8h-source.html">GrSkinInst.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="d4d83abff901eccff4500f217c6af8a9"></a><!-- doxytag: member="GrSkinInst::Pick" ref="d4d83abff901eccff4500f217c6af8a9" args="(GrMesh::TriHitArray &amp;triHits, const MRay &amp;ray) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GrSkinInst::Pick           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_u_fast_array.html">GrMesh::TriHitArray</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>triHits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_m_ray.html">MRay</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>ray</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
picks against the animated mesh. 
<p>
public methods 
<p>Definition at line <a class="el" href="_gr_skin_inst_8cpp-source.html#l00088">88</a> of file <a class="el" href="_gr_skin_inst_8cpp-source.html">GrSkinInst.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="c87444515796dea8b8e939cc43434655"></a><!-- doxytag: member="GrSkinInst::SetBoneMatrix" ref="c87444515796dea8b8e939cc43434655" args="(unsigned int boneId, const MMat4x4 &amp;matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GrSkinInst::SetBoneMatrix           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>boneId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_m_mat4x4.html">MMat4x4</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>matrix</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
mark bones as dirty. If we really want, we can keep a per bone dirty flag, but this generally won't do jack since all of the bones will most likely get changed and set once per frame before we perform the skinning anyways.<p>
set the matrix. 
<p>Definition at line <a class="el" href="_gr_skin_inst_8cpp-source.html#l00119">119</a> of file <a class="el" href="_gr_skin_inst_8cpp-source.html">GrSkinInst.cpp</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>C:/Bootstrap/ProjectBX/Documentation/Code/Engine/Graphics/<a class="el" href="_gr_skin_inst_8h-source.html">GrSkinInst.h</a><li>C:/Bootstrap/ProjectBX/Documentation/Code/Engine/Graphics/<a class="el" href="_gr_skin_inst_8cpp-source.html">GrSkinInst.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Feb 13 17:20:05 2009 for Bootstrap Engine by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
