<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Bootstrap Engine: C:/Bootstrap/ProjectBX/Documentation/Code/Engine/Graphics/GrPolygonUberMapping.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>C:/Bootstrap/ProjectBX/Documentation/Code/Engine/Graphics/GrPolygonUberMapping.cpp</h1><a href="_gr_polygon_uber_mapping_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//----------------------------------------------------------</span>
<a name="l00006"></a>00006 <span class="comment"></span><span class="comment">//----------------------------------------------------------</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include "<a class="code" href="graphics__afx_8h.html">graphics_afx.h</a>"</span>
<a name="l00008"></a>00008 
<a name="l00010"></a>00010 <span class="preprocessor">#include "<a class="code" href="_gr_polygon_uber_mapping_8h.html">GrPolygonUberMapping.h</a>"</span>
<a name="l00011"></a>00011 
<a name="l00013"></a>00013 <span class="preprocessor">#include "<a class="code" href="_gr_polygon_uber_patch_8h.html">GrPolygonUberPatch.h</a>"</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include "<a class="code" href="_gr_polygon_group_8h.html">GrPolygonGroup.h</a>"</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include "<a class="code" href="_gr_polygon_8h.html">GrPolygon.h</a>"</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include "<a class="code" href="_gr_uber_texture_mgr_8h.html">GrUberTextureMgr.h</a>"</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include "<a class="code" href="_gr_uber_texture_8h.html">GrUberTexture.h</a>"</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include "<a class="code" href="_gr_config_8h.html">GrConfig.h</a>"</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include "<a class="code" href="_gr_debug_8h.html">GrDebug.h</a>"</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include "<a class="code" href="_r_file_mgr_8h.html">RFileMgr.h</a>"</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include "<a class="code" href="_r_file_8h.html">RFile.h</a>"</span>
<a name="l00022"></a>00022 
<a name="l00024"></a><a class="code" href="_gr_polygon_uber_mapping_8cpp.html#5b8da22e6c764b63693b3c3aef459740">00024</a> <span class="preprocessor">#define UBERTEX_SIZE_IN_PATCHES                 ( GR_UBERTEX_SIZE_IN_TEXELS / GR_UBERTEX_PATCH_BOUNDARY )</span>
<a name="l00025"></a><a class="code" href="_gr_polygon_uber_mapping_8cpp.html#1a628d3e3aca0163d9fca51068a76a0b">00025</a> <span class="preprocessor"></span><span class="preprocessor">#define UBERTEX_PATCH_SIZE_IN_TILES             ( GR_UBERTEX_PATCH_BOUNDARY / GR_UBERTEX_TILE_SIZE )</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span>
<a name="l00027"></a><a class="code" href="_gr_polygon_uber_mapping_8cpp.html#8d724058d117c4affbbc5c8875b6e087">00027</a> <span class="preprocessor">#define UBERTEX_FLAGS                                   ( RFileMgr::kFlagCreateAlways | RFileMgr::kFlagRead | RFileMgr::kFlagWrite | RFileMgr::kFlagDMA )</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span>
<a name="l00029"></a><a class="code" href="_gr_polygon_uber_mapping_8cpp.html#38fa6d2f5a6fccf06144bd8983585b23">00029</a> <span class="preprocessor">#define DEBUG_RASTERIZER                                0</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span>
<a name="l00032"></a>00032 <span class="preprocessor">#if DEBUG_RASTERIZER</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span>
<a name="l00034"></a>00034 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* _debugImage = 0;
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="preprocessor">#define INIT_DEBUG_IMAGE()                              { _debugImage = ( unsigned char* )AlignedAlloc( 16, 2048 * 2048 ); MemSet( _debugImage, 0, 2048 * 2048 ); }</span>
<a name="l00037"></a>00037 <span class="preprocessor"></span><span class="preprocessor">#define FREE_DEBUG_IMAGE()                              { AlignedFree( _debugImage ); }</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span><span class="preprocessor">#define SAVE_DEBUG_IMAGE()                              { GrSaveTGA( "ubermask.tga", _debugImage, 2048, 2048, 1 ); }</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span><span class="preprocessor">#define DEBUG_IMAGE_WRITE( x, y )               { ( _debugImage[ ( y ) * 2048 + ( x ) ] = 255 ); }</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span>
<a name="l00041"></a>00041 <span class="preprocessor">#else</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span>
<a name="l00043"></a><a class="code" href="_gr_polygon_uber_mapping_8cpp.html#1333bfae3835d5ca55046cd76ba7fe12">00043</a> <span class="preprocessor">#define INIT_DEBUG_IMAGE()                              { }</span>
<a name="l00044"></a><a class="code" href="_gr_polygon_uber_mapping_8cpp.html#4e2d276eb85fc41a50c76e846f374475">00044</a> <span class="preprocessor"></span><span class="preprocessor">#define FREE_DEBUG_IMAGE()                              { }</span>
<a name="l00045"></a><a class="code" href="_gr_polygon_uber_mapping_8cpp.html#db09b2c5e3fc446997ff10c12ad948e7">00045</a> <span class="preprocessor"></span><span class="preprocessor">#define SAVE_DEBUG_IMAGE()                              { }</span>
<a name="l00046"></a><a class="code" href="_gr_polygon_uber_mapping_8cpp.html#e69c95d1d1aa2d641458b27af49c2f18">00046</a> <span class="preprocessor"></span><span class="preprocessor">#define DEBUG_IMAGE_WRITE( x, y )               { }</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span>
<a name="l00048"></a>00048 <span class="preprocessor">#endif</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span>
<a name="l00050"></a>00050 <span class="keywordtype">void</span> <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#161bdbced676440669f99af085b81f82">BitMaskRasterize</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* bitMask, <a class="code" href="struct_s_polygon_vertex.html" title="polygon vertex.">SPolygonVertex</a>* verts, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>* mortonTable );
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="comment">//**********************************************************</span>
<a name="l00054"></a>00054 <span class="comment"></span><span class="comment">//**********************************************************</span>
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="comment">//==========================================================</span>
<a name="l00058"></a>00058 <span class="comment"></span><span class="comment">//==========================================================</span>
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="comment">//----------------------------------------------------------</span>
<a name="l00061"></a><a class="code" href="class_gr_polygon_uber_mapping.html#4a0a0bb05cf7d20a0dd1f77b2b9f07f3">00061</a> <a class="code" href="class_gr_polygon_uber_mapping.html#4a0a0bb05cf7d20a0dd1f77b2b9f07f3" title="class GrPolygonUberMapping">GrPolygonUberMapping::GrPolygonUberMapping</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> uberTexIdx )
<a name="l00062"></a>00062 : _uberTexIdx( uberTexIdx )
<a name="l00063"></a>00063 , _curX( 0 )
<a name="l00064"></a>00064 , _curY( 0 )
<a name="l00065"></a>00065 , _maxY( 0 )
<a name="l00066"></a>00066 {
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 }
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="comment">//----------------------------------------------------------</span>
<a name="l00071"></a><a class="code" href="class_gr_polygon_uber_mapping.html#730ff767c130a871870c2107982b87c5">00071</a> <a class="code" href="class_gr_polygon_uber_mapping.html#730ff767c130a871870c2107982b87c5">GrPolygonUberMapping::~GrPolygonUberMapping</a>()
<a name="l00072"></a>00072 {
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 }
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 <span class="comment">//==========================================================</span>
<a name="l00079"></a>00079 <span class="comment"></span><span class="comment">//==========================================================</span>
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="comment">//----------------------------------------------------------</span>
<a name="l00082"></a>00082 <span class="keywordtype">bool</span>
<a name="l00083"></a><a class="code" href="class_gr_polygon_uber_mapping.html#88872a6fb1778fa4e09bff4f4c58d5c6">00083</a> <a class="code" href="class_gr_polygon_uber_mapping.html#88872a6fb1778fa4e09bff4f4c58d5c6" title="adds an ubertexture to the current patch.">GrPolygonUberMapping::AddPatch</a>( <a class="code" href="class_gr_polygon_uber_patch.html" title="class GrPolygonUberPatch">GrPolygonUberPatch</a>* patch )
<a name="l00084"></a>00084 {
<a name="l00088"></a>00088         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( patch-&gt;<a class="code" href="class_gr_polygon_uber_patch.html#0ee8cbafeeb0689c62e1789d6c016574" title="gets the size of the UV data in texture space.">GetUVSizeInTiles</a>().<a class="code" href="struct_s_vec2.html#328ec1b6dafebcc1eb6bf84f790f39b7">x</a> &gt; 0.0f &amp;&amp; patch-&gt;<a class="code" href="class_gr_polygon_uber_patch.html#0ee8cbafeeb0689c62e1789d6c016574" title="gets the size of the UV data in texture space.">GetUVSizeInTiles</a>().<a class="code" href="struct_s_vec2.html#328ec1b6dafebcc1eb6bf84f790f39b7">x</a> &lt;= <a class="code" href="_gr_config_8h.html#1cf01931ec5f40742e3217a1ef658928" title="Uber texture compile options.">GR_UBERTEX_SIZE_IN_TILES</a> );
<a name="l00089"></a>00089         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( patch-&gt;<a class="code" href="class_gr_polygon_uber_patch.html#0ee8cbafeeb0689c62e1789d6c016574" title="gets the size of the UV data in texture space.">GetUVSizeInTiles</a>().<a class="code" href="struct_s_vec2.html#47cf4560950d17311222a547a98c4fde">y</a> &gt; 0.0f &amp;&amp; patch-&gt;<a class="code" href="class_gr_polygon_uber_patch.html#0ee8cbafeeb0689c62e1789d6c016574" title="gets the size of the UV data in texture space.">GetUVSizeInTiles</a>().<a class="code" href="struct_s_vec2.html#47cf4560950d17311222a547a98c4fde">y</a> &lt;= <a class="code" href="_gr_config_8h.html#1cf01931ec5f40742e3217a1ef658928" title="Uber texture compile options.">GR_UBERTEX_SIZE_IN_TILES</a> );
<a name="l00090"></a>00090 
<a name="l00093"></a>00093         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> patchWidth = ( <a class="code" href="_g_l_aux_8h.html#b832c174e145540d491b0830fc05dbb1">int</a> )<a class="code" href="common__afx_8h.html#5dd3cb8a1d3c9b552f314c2d475a25a2">Ceil</a>( <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#5b8da22e6c764b63693b3c3aef459740" title="class header.">UBERTEX_SIZE_IN_PATCHES</a> * ( patch-&gt;<a class="code" href="class_gr_polygon_uber_patch.html#0ee8cbafeeb0689c62e1789d6c016574" title="gets the size of the UV data in texture space.">GetUVSizeInTiles</a>().<a class="code" href="struct_s_vec2.html#328ec1b6dafebcc1eb6bf84f790f39b7">x</a> / <a class="code" href="_gr_config_8h.html#1cf01931ec5f40742e3217a1ef658928" title="Uber texture compile options.">GR_UBERTEX_SIZE_IN_TILES</a> ) );
<a name="l00094"></a>00094         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> patchHeight = ( <a class="code" href="_g_l_aux_8h.html#b832c174e145540d491b0830fc05dbb1">int</a> )<a class="code" href="common__afx_8h.html#5dd3cb8a1d3c9b552f314c2d475a25a2">Ceil</a>( <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#5b8da22e6c764b63693b3c3aef459740" title="class header.">UBERTEX_SIZE_IN_PATCHES</a> * ( patch-&gt;<a class="code" href="class_gr_polygon_uber_patch.html#0ee8cbafeeb0689c62e1789d6c016574" title="gets the size of the UV data in texture space.">GetUVSizeInTiles</a>().<a class="code" href="struct_s_vec2.html#47cf4560950d17311222a547a98c4fde">y</a> / <a class="code" href="_gr_config_8h.html#1cf01931ec5f40742e3217a1ef658928" title="Uber texture compile options.">GR_UBERTEX_SIZE_IN_TILES</a> ) );
<a name="l00095"></a>00095 
<a name="l00098"></a>00098         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> endX = ( _curX + patchWidth );
<a name="l00099"></a>00099         <span class="keywordflow">if</span> ( endX &gt;= <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#5b8da22e6c764b63693b3c3aef459740" title="class header.">UBERTEX_SIZE_IN_PATCHES</a> )
<a name="l00100"></a>00100         {
<a name="l00102"></a>00102                 _curX = 0;
<a name="l00103"></a>00103                 _curY += _maxY;
<a name="l00104"></a>00104                 endX = patchWidth;
<a name="l00105"></a>00105         }
<a name="l00106"></a>00106 
<a name="l00109"></a>00109         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> endY = ( _curY + patchHeight );
<a name="l00110"></a>00110         <span class="keywordflow">if</span> ( endY &gt;= <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#5b8da22e6c764b63693b3c3aef459740" title="class header.">UBERTEX_SIZE_IN_PATCHES</a> )
<a name="l00111"></a>00111                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00112"></a>00112 
<a name="l00114"></a>00114         patch-&gt;<a class="code" href="class_gr_polygon_uber_patch.html#8504312de783f8dfe605932337209cd9" title="public methods">AssignToUberTexture</a>( _uberTexIdx, _curX * <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#1a628d3e3aca0163d9fca51068a76a0b">UBERTEX_PATCH_SIZE_IN_TILES</a>,
<a name="l00115"></a>00115                 _curY * UBERTEX_PATCH_SIZE_IN_TILES );
<a name="l00116"></a>00116 
<a name="l00119"></a>00119         _curX = endX;
<a name="l00120"></a>00120         _maxY = <a class="code" href="common__afx_8h.html#dd09d155ffe827b203d3236b451752e7">Max</a>( _maxY, patchHeight );
<a name="l00121"></a>00121 
<a name="l00123"></a>00123         _patches.push_back( patch );
<a name="l00124"></a>00124 
<a name="l00127"></a>00127         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00128"></a>00128 }
<a name="l00129"></a>00129 
<a name="l00130"></a>00130 <span class="comment">//----------------------------------------------------------</span>
<a name="l00131"></a>00131 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>
<a name="l00132"></a><a class="code" href="class_gr_polygon_uber_mapping.html#6ca0b2ef19243ef6fe5641e06b411297">00132</a> <a class="code" href="class_gr_polygon_uber_mapping.html#6ca0b2ef19243ef6fe5641e06b411297" title="patch accessors.">GrPolygonUberMapping::GetPatchCount</a>()<span class="keyword"> const</span>
<a name="l00133"></a>00133 <span class="keyword"></span>{
<a name="l00134"></a>00134         <span class="keywordflow">return</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> )_patches.size();
<a name="l00135"></a>00135 }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 <span class="comment">//----------------------------------------------------------</span>
<a name="l00138"></a>00138 <a class="code" href="class_gr_polygon_uber_patch.html" title="class GrPolygonUberPatch">GrPolygonUberPatch</a>*
<a name="l00139"></a><a class="code" href="class_gr_polygon_uber_mapping.html#9d12426e8c882349e60b9c158f5d62a3">00139</a> <a class="code" href="class_gr_polygon_uber_mapping.html#9d12426e8c882349e60b9c158f5d62a3">GrPolygonUberMapping::GetPatch</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx )<span class="keyword"> const</span>
<a name="l00140"></a>00140 <span class="keyword"></span>{
<a name="l00141"></a>00141         <a class="code" href="common__afx_8h.html#2630490ce4292ed6d05359d2957796b8">B_ASSERT</a>( idx &lt; <a class="code" href="class_gr_polygon_uber_mapping.html#6ca0b2ef19243ef6fe5641e06b411297" title="patch accessors.">GetPatchCount</a>() );
<a name="l00142"></a>00142         <span class="keywordflow">return</span> _patches[ idx ];
<a name="l00143"></a>00143 }
<a name="l00144"></a>00144 
<a name="l00145"></a>00145 <span class="comment">//----------------------------------------------------------</span>
<a name="l00146"></a>00146 <a class="code" href="class_u_ref.html">URef&lt; GrUberTexture &gt;</a>
<a name="l00147"></a><a class="code" href="class_gr_polygon_uber_mapping.html#8add114b32b211f1e61ea5aa43b54220">00147</a> <a class="code" href="class_gr_polygon_uber_mapping.html#8add114b32b211f1e61ea5aa43b54220" title="builds an ubertexture out of the currently added geometry.">GrPolygonUberMapping::BuildUberTexture</a>( <span class="keyword">const</span> <a class="code" href="class_u_path.html" title="Purpose: To provide a clean way to represent paths strings.">UPath</a>&amp; <a class="code" href="glext_8h.html#f7477b8725fcf509c9623f64b9d09164">name</a> )<span class="keyword"> const</span>
<a name="l00148"></a>00148 <span class="keyword"></span>{
<a name="l00150"></a>00150         <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#1333bfae3835d5ca55046cd76ba7fe12" title="debug rasterizer switches.">INIT_DEBUG_IMAGE</a>();
<a name="l00151"></a>00151 
<a name="l00153"></a>00153         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bitMaskSize = ( <a class="code" href="_gr_config_8h.html#1cf01931ec5f40742e3217a1ef658928" title="Uber texture compile options.">GR_UBERTEX_SIZE_IN_TILES</a> / 8 ) * <a class="code" href="_gr_config_8h.html#1cf01931ec5f40742e3217a1ef658928" title="Uber texture compile options.">GR_UBERTEX_SIZE_IN_TILES</a>;
<a name="l00154"></a>00154         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* bitMask = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>[ bitMaskSize ];
<a name="l00155"></a>00155         <a class="code" href="common__afx_8h.html#9f04579206286b6dc8c9708063450144" title="memory functions.">MemSet</a>( bitMask, 0, bitMaskSize );
<a name="l00156"></a>00156 
<a name="l00159"></a>00159         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mortonTable[ 2048 ];
<a name="l00160"></a>00160         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 2048; ++i )
<a name="l00161"></a>00161         {
<a name="l00162"></a>00162                 mortonTable[ i ] = 0;
<a name="l00163"></a>00163                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="glext_8h.html#bb269dedb7ad104274cc9f5c0c7285bc">mask</a> = 1;
<a name="l00164"></a>00164                 <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="glext_8h.html#0f71581a41fd2264c8944126dabbd010">b</a> = 0; <a class="code" href="glext_8h.html#0f71581a41fd2264c8944126dabbd010">b</a> &lt; 11; ++<a class="code" href="glext_8h.html#0f71581a41fd2264c8944126dabbd010">b</a>, mask += mask )
<a name="l00165"></a>00165                         mortonTable[ i ] |= ( i &amp; mask ) &lt;&lt; <a class="code" href="glext_8h.html#0f71581a41fd2264c8944126dabbd010">b</a>;
<a name="l00166"></a>00166         }
<a name="l00167"></a>00167 
<a name="l00170"></a>00170         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> patchCount = <a class="code" href="class_gr_polygon_uber_mapping.html#6ca0b2ef19243ef6fe5641e06b411297" title="patch accessors.">GetPatchCount</a>();
<a name="l00171"></a>00171         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; patchCount; ++i )
<a name="l00172"></a>00172         {
<a name="l00174"></a>00174                 <a class="code" href="class_gr_polygon_uber_patch.html" title="class GrPolygonUberPatch">GrPolygonUberPatch</a>* curPatch = <a class="code" href="class_gr_polygon_uber_mapping.html#9d12426e8c882349e60b9c158f5d62a3">GetPatch</a>( i );
<a name="l00175"></a>00175 
<a name="l00177"></a>00177                 <a class="code" href="class_gr_polygon_group.html" title="class GrPolygonGroup">GrPolygonGroup</a>* polygons = curPatch-&gt;<a class="code" href="class_gr_polygon_uber_patch.html#1878a2441e199c1eeaa18a552c38311a" title="provides access to polygons in the current patch.">GetPolygonGroup</a>();
<a name="l00178"></a>00178                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> polyCount = curPatch-&gt;<a class="code" href="class_gr_polygon_uber_patch.html#a47f629d10e1fe72be7ba2407626feca">GetPolygonCount</a>();
<a name="l00179"></a>00179                 <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; polyCount; ++j )
<a name="l00180"></a>00180                 {
<a name="l00182"></a>00182                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> curPolygonIdx = curPatch-&gt;<a class="code" href="class_gr_polygon_uber_patch.html#51940d367acf3e294341efc596f518cf">GetPolygonIndex</a>( j );
<a name="l00183"></a>00183                         <span class="keyword">const</span> <a class="code" href="class_gr_polygon.html" title="class GrPolygon">GrPolygon</a>&amp; curPolygon = polygons-&gt;<a class="code" href="class_gr_polygon_group.html#267706848b196a4f1b7b0ebdeeb7188e">GetPolygon</a>( curPolygonIdx );
<a name="l00184"></a>00184 
<a name="l00186"></a>00186                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> triCount = curPolygon.<a class="code" href="class_gr_polygon.html#18ae3ecb1015c722fb8379d8267b9464">GetTriangleCount</a>();
<a name="l00187"></a>00187                         <a class="code" href="struct_s_polygon_vertex.html" title="polygon vertex.">SPolygonVertex</a>* triVerts = ( <a class="code" href="struct_s_polygon_vertex.html" title="polygon vertex.">SPolygonVertex</a>* )<a class="code" href="common__afx_8cpp.html#a38123a381fda4eb71767e320a1331d1" title="temporary memory allocation">TempAlloc</a>( 3 * triCount * <span class="keyword">sizeof</span>( <a class="code" href="struct_s_polygon_vertex.html" title="polygon vertex.">SPolygonVertex</a> ) );
<a name="l00188"></a>00188                         curPolygon.<a class="code" href="class_gr_polygon.html#94c81cc3e6f419a814119a7dc3c4d78b">Triangulate</a>( triVerts );
<a name="l00189"></a>00189 
<a name="l00191"></a>00191                         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; triCount; ++k )
<a name="l00192"></a>00192                         {
<a name="l00194"></a>00194                                 <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#161bdbced676440669f99af085b81f82">BitMaskRasterize</a>( bitMask, triVerts + 3 * k, mortonTable );
<a name="l00195"></a>00195                         }
<a name="l00196"></a>00196 
<a name="l00198"></a>00198                         <a class="code" href="common__afx_8cpp.html#4f8b297dfd37bb5e5081041d840d19cf">TempFree</a>( triVerts );
<a name="l00199"></a>00199                 }
<a name="l00200"></a>00200         }
<a name="l00201"></a>00201 
<a name="l00203"></a>00203         <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#db09b2c5e3fc446997ff10c12ad948e7">SAVE_DEBUG_IMAGE</a>();
<a name="l00204"></a>00204         <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#4e2d276eb85fc41a50c76e846f374475">FREE_DEBUG_IMAGE</a>();
<a name="l00205"></a>00205 
<a name="l00207"></a>00207         <a class="code" href="class_gr_uber_texture.html" title="class GrUberTexture">GrUberTexture</a>* newTexture = <a class="code" href="_gr_uber_texture_mgr_8cpp.html#20de74e7984a83a6a89dbbe954983027" title="class header.">gGrUberTextureMgr</a>-&gt;<a class="code" href="class_gr_uber_texture_mgr.html#5b50e74d5a3b89b7fe22adc1731bca14" title="public methods">CreateUberTexture</a>( name, bitMask );
<a name="l00208"></a>00208 
<a name="l00210"></a>00210         <span class="keyword">delete</span>[] bitMask;
<a name="l00211"></a>00211 
<a name="l00213"></a>00213         <span class="keywordflow">return</span> 0;
<a name="l00214"></a>00214 }
<a name="l00215"></a>00215 
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 <span class="comment">//**********************************************************</span>
<a name="l00219"></a>00219 <span class="comment"></span><span class="comment">//**********************************************************</span>
<a name="l00220"></a>00220 
<a name="l00222"></a><a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8">00222</a> <span class="preprocessor">#define LINE_SIDE( a, b, c, x, y )                      ( ( ( a ) * ( ( double )( x ) ) + ( b ) * ( ( double )( y ) + 0 ) + ( c ) ) &lt; 0.0 )</span>
<a name="l00223"></a>00223 <span class="preprocessor"></span>
<a name="l00224"></a>00224 <span class="comment">//----------------------------------------------------------</span>
<a name="l00225"></a>00225 <span class="keywordtype">void</span>
<a name="l00226"></a><a class="code" href="_gr_polygon_uber_mapping_8cpp.html#161bdbced676440669f99af085b81f82">00226</a> <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#161bdbced676440669f99af085b81f82">BitMaskRasterize</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>* bitMask, <a class="code" href="struct_s_polygon_vertex.html" title="polygon vertex.">SPolygonVertex</a>* verts, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>* mortonTable )
<a name="l00227"></a>00227 {
<a name="l00228"></a>00228         <span class="keywordtype">double</span> x0 = verts[ 0 ].<a class="code" href="struct_s_polygon_vertex.html#022e87802986b84acbdae9c27e689c12" title="0 = blue, 1 = green, 2 = red, 3 = alpha.">uv</a>.<a class="code" href="struct_s_vec2.html#328ec1b6dafebcc1eb6bf84f790f39b7">x</a> * <a class="code" href="_gr_config_8h.html#1cf01931ec5f40742e3217a1ef658928" title="Uber texture compile options.">GR_UBERTEX_SIZE_IN_TILES</a>;
<a name="l00229"></a>00229         <span class="keywordtype">double</span> y0 = verts[ 0 ].<a class="code" href="struct_s_polygon_vertex.html#022e87802986b84acbdae9c27e689c12" title="0 = blue, 1 = green, 2 = red, 3 = alpha.">uv</a>.<a class="code" href="struct_s_vec2.html#47cf4560950d17311222a547a98c4fde">y</a> * <a class="code" href="_gr_config_8h.html#1cf01931ec5f40742e3217a1ef658928" title="Uber texture compile options.">GR_UBERTEX_SIZE_IN_TILES</a>;
<a name="l00230"></a>00230         <span class="keywordtype">double</span> x1 = verts[ 1 ].<a class="code" href="struct_s_polygon_vertex.html#022e87802986b84acbdae9c27e689c12" title="0 = blue, 1 = green, 2 = red, 3 = alpha.">uv</a>.<a class="code" href="struct_s_vec2.html#328ec1b6dafebcc1eb6bf84f790f39b7">x</a> * <a class="code" href="_gr_config_8h.html#1cf01931ec5f40742e3217a1ef658928" title="Uber texture compile options.">GR_UBERTEX_SIZE_IN_TILES</a>;
<a name="l00231"></a>00231         <span class="keywordtype">double</span> y1 = verts[ 1 ].<a class="code" href="struct_s_polygon_vertex.html#022e87802986b84acbdae9c27e689c12" title="0 = blue, 1 = green, 2 = red, 3 = alpha.">uv</a>.<a class="code" href="struct_s_vec2.html#47cf4560950d17311222a547a98c4fde">y</a> * <a class="code" href="_gr_config_8h.html#1cf01931ec5f40742e3217a1ef658928" title="Uber texture compile options.">GR_UBERTEX_SIZE_IN_TILES</a>;
<a name="l00232"></a>00232         <span class="keywordtype">double</span> x2 = verts[ 2 ].<a class="code" href="struct_s_polygon_vertex.html#022e87802986b84acbdae9c27e689c12" title="0 = blue, 1 = green, 2 = red, 3 = alpha.">uv</a>.<a class="code" href="struct_s_vec2.html#328ec1b6dafebcc1eb6bf84f790f39b7">x</a> * <a class="code" href="_gr_config_8h.html#1cf01931ec5f40742e3217a1ef658928" title="Uber texture compile options.">GR_UBERTEX_SIZE_IN_TILES</a>;
<a name="l00233"></a>00233         <span class="keywordtype">double</span> y2 = verts[ 2 ].<a class="code" href="struct_s_polygon_vertex.html#022e87802986b84acbdae9c27e689c12" title="0 = blue, 1 = green, 2 = red, 3 = alpha.">uv</a>.<a class="code" href="struct_s_vec2.html#47cf4560950d17311222a547a98c4fde">y</a> * <a class="code" href="_gr_config_8h.html#1cf01931ec5f40742e3217a1ef658928" title="Uber texture compile options.">GR_UBERTEX_SIZE_IN_TILES</a>;
<a name="l00234"></a>00234 
<a name="l00236"></a>00236         <span class="keywordtype">double</span> a0 = y1 - y0;
<a name="l00237"></a>00237         <span class="keywordtype">double</span> b0 = x0 - x1;
<a name="l00238"></a>00238         <span class="keywordtype">double</span> c0 = -( a0 * x0 + b0 * y0 );
<a name="l00239"></a>00239 
<a name="l00241"></a>00241         <span class="keywordflow">if</span> ( ( a0 * x2 + b0 * y2 + c0 ) &lt; 0 )
<a name="l00242"></a>00242         {
<a name="l00244"></a>00244                 <a class="code" href="common__afx_8h.html#400f1491dc09805bdbb254cb258e7b41">Swap</a>( x0, x1 );
<a name="l00245"></a>00245                 <a class="code" href="common__afx_8h.html#400f1491dc09805bdbb254cb258e7b41">Swap</a>( y0, y1 );
<a name="l00246"></a>00246 
<a name="l00248"></a>00248                 a0 = -a0;
<a name="l00249"></a>00249                 b0 = -b0;
<a name="l00250"></a>00250                 c0 = -( a0 * x0 + b0 * y0 );
<a name="l00251"></a>00251         }
<a name="l00252"></a>00252 
<a name="l00254"></a>00254         <span class="keywordtype">double</span> a1 = y2 - y1;
<a name="l00255"></a>00255         <span class="keywordtype">double</span> b1 = x1 - x2;
<a name="l00256"></a>00256         <span class="keywordtype">double</span> c1 = -( a1 * x1 + b1 * y1 );
<a name="l00257"></a>00257 
<a name="l00259"></a>00259         <span class="keywordtype">double</span> a2 = y0 - y2;
<a name="l00260"></a>00260         <span class="keywordtype">double</span> b2 = x2 - x0;
<a name="l00261"></a>00261         <span class="keywordtype">double</span> c2 = -( a2 * x2 + b2 * y2 );
<a name="l00262"></a>00262 
<a name="l00264"></a>00264         <span class="keywordtype">int</span> minX = ( <a class="code" href="_g_l_aux_8h.html#b832c174e145540d491b0830fc05dbb1">int</a> )<a class="code" href="common__afx_8h.html#d7752a7ed75d8ebf6dfa7fbdcca395ba">Floor</a>( ( <span class="keywordtype">float</span> )<a class="code" href="common__afx_8h.html#de0f1d8a58fa081cd90c9ee9c6077bf4">Min3</a>( x0, x1, x2 ) );
<a name="l00265"></a>00265         <span class="keywordtype">int</span> minY = ( <a class="code" href="_g_l_aux_8h.html#b832c174e145540d491b0830fc05dbb1">int</a> )<a class="code" href="common__afx_8h.html#d7752a7ed75d8ebf6dfa7fbdcca395ba">Floor</a>( ( <span class="keywordtype">float</span> )<a class="code" href="common__afx_8h.html#de0f1d8a58fa081cd90c9ee9c6077bf4">Min3</a>( y0, y1, y2 ) );
<a name="l00266"></a>00266         <span class="keywordtype">int</span> maxX = ( <a class="code" href="_g_l_aux_8h.html#b832c174e145540d491b0830fc05dbb1">int</a> )<a class="code" href="common__afx_8h.html#5dd3cb8a1d3c9b552f314c2d475a25a2">Ceil</a>( ( <span class="keywordtype">float</span> )<a class="code" href="common__afx_8h.html#33921919086132106ca09666fcf7432a">Max3</a>( x0, x1, x2 ) );
<a name="l00267"></a>00267         <span class="keywordtype">int</span> maxY = ( <a class="code" href="_g_l_aux_8h.html#b832c174e145540d491b0830fc05dbb1">int</a> )<a class="code" href="common__afx_8h.html#5dd3cb8a1d3c9b552f314c2d475a25a2">Ceil</a>( ( <span class="keywordtype">float</span> )<a class="code" href="common__afx_8h.html#33921919086132106ca09666fcf7432a">Max3</a>( y0, y1, y2 ) );
<a name="l00268"></a>00268 
<a name="l00270"></a>00270         <span class="keywordtype">int</span> coverage0 = 0;
<a name="l00271"></a>00271         <span class="keywordtype">int</span> coverage1 = 0;
<a name="l00272"></a>00272         <span class="keywordtype">int</span> coverage2 = 0;
<a name="l00273"></a>00273         <span class="keywordtype">int</span> minBlockX = minX &amp; ~7;
<a name="l00274"></a>00274         <span class="keywordtype">int</span> minBlockY = minY &amp; ~7;
<a name="l00275"></a>00275         <span class="keywordtype">int</span> maxBlockX = maxX &amp; ~7;
<a name="l00276"></a>00276         <span class="keywordtype">int</span> maxBlockY = maxY &amp; ~7;
<a name="l00277"></a>00277         <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> = minBlockY; <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> &lt;= maxBlockY; <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> += 8 )
<a name="l00278"></a>00278         {
<a name="l00279"></a>00279                 <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> bx = minBlockX; bx &lt;= maxBlockX; bx += 8 )
<a name="l00280"></a>00280                 {
<a name="l00282"></a>00282                         coverage0 =  <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a0, b0, c0, bx + 0, <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> + 0 );
<a name="l00283"></a>00283                         coverage0 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a0, b0, c0, bx + 8, <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> + 0 );
<a name="l00284"></a>00284                         coverage0 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a0, b0, c0, bx + 0, <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> + 8 );
<a name="l00285"></a>00285                         coverage0 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a0, b0, c0, bx + 8, <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> + 8 );
<a name="l00286"></a>00286                         <span class="keywordflow">if</span> ( coverage0 == 4 )
<a name="l00287"></a>00287                                 <span class="keywordflow">continue</span>;
<a name="l00288"></a>00288 
<a name="l00289"></a>00289                         coverage1 =  <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a1, b1, c1, bx + 0, <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> + 0 );
<a name="l00290"></a>00290                         coverage1 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a1, b1, c1, bx + 8, <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> + 0 );
<a name="l00291"></a>00291                         coverage1 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a1, b1, c1, bx + 0, <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> + 8 );
<a name="l00292"></a>00292                         coverage1 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a1, b1, c1, bx + 8, <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> + 8 );
<a name="l00293"></a>00293                         <span class="keywordflow">if</span> ( coverage1 == 4 )
<a name="l00294"></a>00294                                 <span class="keywordflow">continue</span>;
<a name="l00295"></a>00295 
<a name="l00296"></a>00296                         coverage2 =  <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a2, b2, c2, bx + 0, <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> + 0 );
<a name="l00297"></a>00297                         coverage2 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a2, b2, c2, bx + 8, <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> + 0 );
<a name="l00298"></a>00298                         coverage2 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a2, b2, c2, bx + 0, <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> + 8 );
<a name="l00299"></a>00299                         coverage2 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a2, b2, c2, bx + 8, <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> + 8 );
<a name="l00300"></a>00300                         <span class="keywordflow">if</span> ( coverage2 == 4 )
<a name="l00301"></a>00301                                 <span class="keywordflow">continue</span>;
<a name="l00302"></a>00302 
<a name="l00304"></a>00304                         <span class="keywordflow">if</span> ( ( coverage0 + coverage1 + coverage2 ) == 0 )
<a name="l00305"></a>00305                         {
<a name="l00308"></a>00308                                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> xBits = mortonTable[ bx ];
<a name="l00309"></a>00309                                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> yBits = mortonTable[ <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> ];
<a name="l00310"></a>00310                                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="glext_8h.html#57f14e05b1900f16a2da82ade47d0c6d">index</a> = ( yBits + yBits ) | xBits;
<a name="l00311"></a>00311 
<a name="l00313"></a>00313                                 index &gt;&gt;= 3;
<a name="l00314"></a>00314 
<a name="l00317"></a>00317                                 bitMask[ index + 0 ] = ~0;
<a name="l00318"></a>00318                                 bitMask[ index + 1 ] = ~0;
<a name="l00319"></a>00319                                 bitMask[ index + 2 ] = ~0;
<a name="l00320"></a>00320                                 bitMask[ index + 3 ] = ~0;
<a name="l00321"></a>00321                                 bitMask[ index + 4 ] = ~0;
<a name="l00322"></a>00322                                 bitMask[ index + 5 ] = ~0;
<a name="l00323"></a>00323                                 bitMask[ index + 6 ] = ~0;
<a name="l00324"></a>00324                                 bitMask[ index + 7 ] = ~0;
<a name="l00325"></a>00325 
<a name="l00326"></a>00326 <span class="preprocessor">#if DEBUG_RASTERIZER</span>
<a name="l00327"></a>00327 <span class="preprocessor"></span>                                <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 8; ++i )
<a name="l00328"></a>00328                                 {
<a name="l00329"></a>00329                                         <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; 8; ++j )
<a name="l00330"></a>00330                                         {
<a name="l00331"></a>00331                                                 <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#e69c95d1d1aa2d641458b27af49c2f18">DEBUG_IMAGE_WRITE</a>( bx + j, <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> + i );
<a name="l00332"></a>00332                                         }
<a name="l00333"></a>00333                                 }
<a name="l00334"></a>00334 <span class="preprocessor">#endif</span>
<a name="l00335"></a>00335 <span class="preprocessor"></span>
<a name="l00337"></a>00337                                 <span class="keywordflow">continue</span>;
<a name="l00338"></a>00338                         }
<a name="l00339"></a>00339                         <span class="keywordflow">else</span>
<a name="l00340"></a>00340                         {
<a name="l00343"></a>00343                                 <span class="keywordtype">int</span> <a class="code" href="_g_l_8h.html#9298c7ad619074f5285b32c6b72bfdea">y</a> = <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a>;
<a name="l00344"></a>00344                                 <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; 8; ++i, ++y )
<a name="l00345"></a>00345                                 {
<a name="l00346"></a>00346                                         <span class="keywordtype">int</span> <a class="code" href="glext_8h.html#d77deca22f617d3f0e0eb786445689fc">x</a> = bx;
<a name="l00347"></a>00347                                         <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> j = 0; j &lt; 8; ++j, ++x )
<a name="l00348"></a>00348                                         {
<a name="l00350"></a>00350                                                 coverage0 =  <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a0, b0, c0, x + 0, y + 0 );
<a name="l00351"></a>00351                                                 coverage0 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a0, b0, c0, x + 1, y + 0 );
<a name="l00352"></a>00352                                                 coverage0 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a0, b0, c0, x + 0, y + 1 );
<a name="l00353"></a>00353                                                 coverage0 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a0, b0, c0, x + 1, y + 1 );
<a name="l00354"></a>00354                                                 <span class="keywordflow">if</span> ( coverage0 == 4 )
<a name="l00355"></a>00355                                                         <span class="keywordflow">continue</span>;
<a name="l00356"></a>00356 
<a name="l00357"></a>00357                                                 coverage1 =  <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a1, b1, c1, x + 0, y + 0 );
<a name="l00358"></a>00358                                                 coverage1 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a1, b1, c1, x + 1, y + 0 );
<a name="l00359"></a>00359                                                 coverage1 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a1, b1, c1, x + 0, y + 1 );
<a name="l00360"></a>00360                                                 coverage1 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a1, b1, c1, x + 1, y + 1 );
<a name="l00361"></a>00361                                                 <span class="keywordflow">if</span> ( coverage1 == 4 )
<a name="l00362"></a>00362                                                         <span class="keywordflow">continue</span>;
<a name="l00363"></a>00363 
<a name="l00364"></a>00364                                                 coverage2 =  <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a2, b2, c2, x + 0, y + 0 );
<a name="l00365"></a>00365                                                 coverage2 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a2, b2, c2, x + 1, y + 0 );
<a name="l00366"></a>00366                                                 coverage2 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a2, b2, c2, x + 0, y + 1 );
<a name="l00367"></a>00367                                                 coverage2 += <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#84ea8002a883810b0d5593e81e9dcfe8" title="File local functions.">LINE_SIDE</a>( a2, b2, c2, x + 1, y + 1 );
<a name="l00368"></a>00368                                                 <span class="keywordflow">if</span> ( coverage2 == 4 )
<a name="l00369"></a>00369                                                         <span class="keywordflow">continue</span>;
<a name="l00370"></a>00370 
<a name="l00374"></a>00374                                                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> xBits = mortonTable[ bx ];
<a name="l00375"></a>00375                                                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> yBits = mortonTable[ <a class="code" href="glext_8h.html#ee54e9aab2837a54be2ff5fb1c073bd2">by</a> ];
<a name="l00376"></a>00376                                                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="glext_8h.html#57f14e05b1900f16a2da82ade47d0c6d">index</a> = ( yBits + yBits ) | xBits;
<a name="l00377"></a>00377 
<a name="l00379"></a>00379                                                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> byteOffset = index &gt;&gt; 3;
<a name="l00380"></a>00380                                                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bitIndex = index &amp; 7;
<a name="l00381"></a>00381 
<a name="l00383"></a>00383                                                 bitMask[ byteOffset ] |= ( 1 &lt;&lt; bitIndex );
<a name="l00384"></a>00384 
<a name="l00386"></a>00386                                                 <a class="code" href="_gr_polygon_uber_mapping_8cpp.html#e69c95d1d1aa2d641458b27af49c2f18">DEBUG_IMAGE_WRITE</a>( x, y );
<a name="l00387"></a>00387                                         }
<a name="l00388"></a>00388                                 }
<a name="l00389"></a>00389                         }
<a name="l00390"></a>00390                 }
<a name="l00391"></a>00391         }
<a name="l00392"></a>00392 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Feb 13 17:19:57 2009 for Bootstrap Engine by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
