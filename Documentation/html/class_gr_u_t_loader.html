<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Bootstrap Engine: GrUTLoader Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>GrUTLoader Class Reference</h1><!-- doxytag: class="GrUTLoader" -->class <a class="el" href="class_gr_u_t_loader.html" title="class GrUTLoader">GrUTLoader</a>  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="_gr_u_t_loader_8h-source.html">GrUTLoader.h</a>&gt;</code>
<p>

<p>
<a href="class_gr_u_t_loader-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_u_t_loader.html#328b8875d7cc411c1ad47f0d9279d8f2">ECOLORMODE</a> { <a class="el" href="class_gr_u_t_loader.html#328b8875d7cc411c1ad47f0d9279d8f29ec4865a1ef98ef310b97499681bbdc9">EDM_BGRA</a>, 
<a class="el" href="class_gr_u_t_loader.html#328b8875d7cc411c1ad47f0d9279d8f2b0937d274d38a74ec18365d251e853d2">EDM_BGRA_DXT</a>, 
<a class="el" href="class_gr_u_t_loader.html#328b8875d7cc411c1ad47f0d9279d8f256ee2c13f924e5f97453e60e1c53fac2">EDM_YCoCg</a>, 
<a class="el" href="class_gr_u_t_loader.html#328b8875d7cc411c1ad47f0d9279d8f2965295944f1e1f65bb7ddce0508c4567">EDM_YCoCg_DXT</a>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_u_t_loader.html#b2a7be2e554d43ef1a6b4851ef4e0f39">ProgressCallback</a> )(const char *stepText, unsigned int stepCount, unsigned int step, unsigned int stepProgress)</td></tr>

<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_u_t_loader.html#d422dad3e01b8a264d6b4e3976736e81">GrUTLoader</a> (unsigned int workerThreadCount=2)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">class <a class="el" href="class_gr_u_t_loader.html" title="class GrUTLoader">GrUTLoader</a>  <a href="#d422dad3e01b8a264d6b4e3976736e81"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_u_t_loader.html#470a07f30f44b351519508c66b11ef22">~GrUTLoader</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_gr_u_t_atlas.html">GrUTAtlas</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_u_t_loader.html#9a52f424b6e3bb62afbfbd05e13d048a">CreateUbertex</a> (void *file, const void *tileUseBitMask, const void *metaData, unsigned int metaDataSize, <a class="el" href="class_gr_u_t_loader.html#b2a7be2e554d43ef1a6b4851ef4e0f39">ProgressCallback</a> callback)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">public methods  <a href="#9a52f424b6e3bb62afbfbd05e13d048a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_gr_u_t_atlas.html">GrUTAtlas</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_u_t_loader.html#8e7dbf8a92517c281d2b0587a4bcdf55">LoadUbertex</a> (void *file)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_u_t_loader.html#291cd71cede4de0eafd22aad048f50e6">ChangeLayout</a> (void *file, const void *tileUseBitMask, <a class="el" href="class_gr_u_t_loader.html#b2a7be2e554d43ef1a6b4851ef4e0f39">ProgressCallback</a> callback)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_u_t_loader.html#c61068d4af869e277fa8303dd2fc6689">FreeAtlas</a> (<a class="el" href="class_gr_u_t_atlas.html">GrUTAtlas</a> *atlas)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">call this to free an atlas.  <a href="#c61068d4af869e277fa8303dd2fc6689"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_u_t_loader.html#021fb0768072b4306207993a4e8e5415">DecodeChunk</a> (void *<a class="el" href="glext__bak_8h.html#92034251bfd455d524a9b5610cddba00">dst</a>, volatile int *lock, void *file, unsigned int chunkIndex, <a class="el" href="class_gr_u_t_loader.html#328b8875d7cc411c1ad47f0d9279d8f2">ECOLORMODE</a> dxtMode=GrUTLoader::EDM_BGRA_DXT)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_u_t_loader.html#9eca6963597c1c7e5c1f378774606f2f">WriteChunk</a> (void *file, unsigned int chunkIndex, const void *<a class="el" href="glext__bak_8h.html#72e0fdf0f845ded60b1fada9e9195cd7">src</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_gr_u_t_loader.html#a2715cc250d1bdbb321200ef630756cb">Flush</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">wait for all decode requests to finish.  <a href="#a2715cc250d1bdbb321200ef630756cb"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
class <a class="el" href="class_gr_u_t_loader.html" title="class GrUTLoader">GrUTLoader</a> 
<p>Definition at line <a class="el" href="_gr_u_t_loader_8h-source.html#l00022">22</a> of file <a class="el" href="_gr_u_t_loader_8h-source.html">GrUTLoader.h</a>.</p>
<hr><h2>Member Typedef Documentation</h2>
<a class="anchor" name="b2a7be2e554d43ef1a6b4851ef4e0f39"></a><!-- doxytag: member="GrUTLoader::ProgressCallback" ref="b2a7be2e554d43ef1a6b4851ef4e0f39" args=")(const char *stepText, unsigned int stepCount, unsigned int step, unsigned int stepProgress)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void( * <a class="el" href="class_gr_u_t_loader.html#b2a7be2e554d43ef1a6b4851ef4e0f39">GrUTLoader::ProgressCallback</a>)(const char *stepText, unsigned int stepCount, unsigned int step, unsigned int stepProgress)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This callback is called whenever progress is updated. It's called 256 times, where the value 255 means the operation was just completed. 
</div>
</div><p>
<hr><h2>Member Enumeration Documentation</h2>
<a class="anchor" name="328b8875d7cc411c1ad47f0d9279d8f2"></a><!-- doxytag: member="GrUTLoader::ECOLORMODE" ref="328b8875d7cc411c1ad47f0d9279d8f2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="class_gr_u_t_loader.html#328b8875d7cc411c1ad47f0d9279d8f2">GrUTLoader::ECOLORMODE</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="328b8875d7cc411c1ad47f0d9279d8f29ec4865a1ef98ef310b97499681bbdc9"></a><!-- doxytag: member="EDM_BGRA" ref="328b8875d7cc411c1ad47f0d9279d8f29ec4865a1ef98ef310b97499681bbdc9" args="" -->EDM_BGRA</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" name="328b8875d7cc411c1ad47f0d9279d8f2b0937d274d38a74ec18365d251e853d2"></a><!-- doxytag: member="EDM_BGRA_DXT" ref="328b8875d7cc411c1ad47f0d9279d8f2b0937d274d38a74ec18365d251e853d2" args="" -->EDM_BGRA_DXT</em>&nbsp;</td><td>
nx, ny, b, g, r, b, g, r </td></tr>
<tr><td valign="top"><em><a class="anchor" name="328b8875d7cc411c1ad47f0d9279d8f256ee2c13f924e5f97453e60e1c53fac2"></a><!-- doxytag: member="EDM_YCoCg" ref="328b8875d7cc411c1ad47f0d9279d8f256ee2c13f924e5f97453e60e1c53fac2" args="" -->EDM_YCoCg</em>&nbsp;</td><td>
DXT5 (r = nx, a = ny), DXT5(b, g, r, a), DXT5(b, g, r, a). </td></tr>
<tr><td valign="top"><em><a class="anchor" name="328b8875d7cc411c1ad47f0d9279d8f2965295944f1e1f65bb7ddce0508c4567"></a><!-- doxytag: member="EDM_YCoCg_DXT" ref="328b8875d7cc411c1ad47f0d9279d8f2965295944f1e1f65bb7ddce0508c4567" args="" -->EDM_YCoCg_DXT</em>&nbsp;</td><td>
nx, ny, Y, Co, Cg, a, Y, Co, Cg, a </td></tr>
</table>
</dl>

<p>Definition at line <a class="el" href="_gr_u_t_loader_8h-source.html#l00031">31</a> of file <a class="el" href="_gr_u_t_loader_8h-source.html">GrUTLoader.h</a>.</p>

</div>
</div><p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="d422dad3e01b8a264d6b4e3976736e81"></a><!-- doxytag: member="GrUTLoader::GrUTLoader" ref="d422dad3e01b8a264d6b4e3976736e81" args="(unsigned int workerThreadCount=2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GrUTLoader::GrUTLoader           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>workerThreadCount</em> = <code>2</code>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
class <a class="el" href="class_gr_u_t_loader.html" title="class GrUTLoader">GrUTLoader</a> 
<p>
ctor &amp; dtor 
<p>
set the singleton pointer.<p>
initialize all queue entries.<p>
allocate memory for tile data.<p>
initialize the compression services.<p>
allocate write buffers.<p>
initialize the encoder and the decoder.<p>
start the worker thread. 
<p>Definition at line <a class="el" href="_gr_u_t_loader_8cpp-source.html#l00141">141</a> of file <a class="el" href="_gr_u_t_loader_8cpp-source.html">GrUTLoader.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="470a07f30f44b351519508c66b11ef22"></a><!-- doxytag: member="GrUTLoader::~GrUTLoader" ref="470a07f30f44b351519508c66b11ef22" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GrUTLoader::~GrUTLoader           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
wait for everything to finish and free memory.<p>
wait for the current entry to finish.<p>
free memory.<p>
issue the stop command for the worker thread.<p>
issue the quit command and wait until a thread consumes it. Once it's consumed, repeat until all threads have processed the event.<p>
free write buffers.<p>
clear the singleton pointer. 
<p>Definition at line <a class="el" href="_gr_u_t_loader_8cpp-source.html#l00189">189</a> of file <a class="el" href="_gr_u_t_loader_8cpp-source.html">GrUTLoader.cpp</a>.</p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="291cd71cede4de0eafd22aad048f50e6"></a><!-- doxytag: member="GrUTLoader::ChangeLayout" ref="291cd71cede4de0eafd22aad048f50e6" args="(void *file, const void *tileUseBitMask, ProgressCallback callback)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GrUTLoader::ChangeLayout           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>tileUseBitMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_gr_u_t_loader.html#b2a7be2e554d43ef1a6b4851ef4e0f39">ProgressCallback</a>&nbsp;</td>
          <td class="paramname"> <em>callback</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
flush any pending read requests.<p>
create a backup of the current file. 
<p>Definition at line <a class="el" href="_gr_u_t_loader_8cpp-source.html#l00380">380</a> of file <a class="el" href="_gr_u_t_loader_8cpp-source.html">GrUTLoader.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="9a52f424b6e3bb62afbfbd05e13d048a"></a><!-- doxytag: member="GrUTLoader::CreateUbertex" ref="9a52f424b6e3bb62afbfbd05e13d048a" args="(void *file, const void *tileUseBitMask, const void *metaData, unsigned int metaDataSize, ProgressCallback callback)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_gr_u_t_atlas.html">GrUTAtlas</a> * GrUTLoader::CreateUbertex           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>tileUseBitMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>metaData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>metaDataSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_gr_u_t_loader.html#b2a7be2e554d43ef1a6b4851ef4e0f39">ProgressCallback</a>&nbsp;</td>
          <td class="paramname"> <em>callback</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
public methods 
<p>
builds an ubertexture using the data specified. Note that the tile-use mask contains a bit for every tile, and specifies 1 for tiles that are used, and 0 for tiles that are not. Note that tiles are in morton order (bit 0 = 0,0, bit 1 = 1,0, bit 2 = 0,1, etc.) 
<p>
flush any pending read requests.<p>
calculate the maximum amount of data that can be written by RLE compression.<p>
allocate space for RLE compressed tile usage data and compress.<p>
calculate data starting locations.<p>
allocate a temporary buffer for writing to the file.<p>
write out the header.<p>
copy the meta data.<p>
copy the atlas data.<p>
write any additional data.<p>
flush the header data to the disk.<p>
delete the buffer.<p>
now build an atlas and fill out the chunks with default data.<p>
fill out a default tile data.<p>
write out all chunks in the file.<p>
return the atlas. 
<p>Definition at line <a class="el" href="_gr_u_t_loader_8cpp-source.html#l00228">228</a> of file <a class="el" href="_gr_u_t_loader_8cpp-source.html">GrUTLoader.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="021fb0768072b4306207993a4e8e5415"></a><!-- doxytag: member="GrUTLoader::DecodeChunk" ref="021fb0768072b4306207993a4e8e5415" args="(void *dst, volatile int *lock, void *file, unsigned int chunkIndex, ECOLORMODE dxtMode=GrUTLoader::EDM_BGRA_DXT)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GrUTLoader::DecodeChunk           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">volatile int *&nbsp;</td>
          <td class="paramname"> <em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>chunkIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_gr_u_t_loader.html#328b8875d7cc411c1ad47f0d9279d8f2">ECOLORMODE</a>&nbsp;</td>
          <td class="paramname"> <em>dxtMode</em> = <code>GrUTLoader::EDM_BGRA_DXT</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
reads a tile from the ubertexture file. Note that dxtEncode is a boolean variable. This causes all channels to be packed as follows: RGTC, DXT5, DXT5. 
<p>
find an empty slot in the queue.<p>
try to gain ownership over the entry.<p>
set the lock flag to LOCK_TAKEN<p>
fill out the current queue entry.<p>
fill out file and tile information.<p>
look-up the location in the file. Note that we add one to advance past the header.<p>
issue the read request. The worker thread will detect when data is ready and will begin processing tile data as soon as possible. 
<p>Definition at line <a class="el" href="_gr_u_t_loader_8cpp-source.html#l00401">401</a> of file <a class="el" href="_gr_u_t_loader_8cpp-source.html">GrUTLoader.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="a2715cc250d1bdbb321200ef630756cb"></a><!-- doxytag: member="GrUTLoader::Flush" ref="a2715cc250d1bdbb321200ef630756cb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GrUTLoader::Flush           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
wait for all decode requests to finish. 
<p>

<p>
wait for all commands to be completed. 
<p>Definition at line <a class="el" href="_gr_u_t_loader_8cpp-source.html#l00487">487</a> of file <a class="el" href="_gr_u_t_loader_8cpp-source.html">GrUTLoader.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="c61068d4af869e277fa8303dd2fc6689"></a><!-- doxytag: member="GrUTLoader::FreeAtlas" ref="c61068d4af869e277fa8303dd2fc6689" args="(GrUTAtlas *atlas)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GrUTLoader::FreeAtlas           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_gr_u_t_atlas.html">GrUTAtlas</a> *&nbsp;</td>
          <td class="paramname"> <em>atlas</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
call this to free an atlas. 
<p>

<p>Definition at line <a class="el" href="_gr_u_t_loader_8cpp-source.html#l00394">394</a> of file <a class="el" href="_gr_u_t_loader_8cpp-source.html">GrUTLoader.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="8e7dbf8a92517c281d2b0587a4bcdf55"></a><!-- doxytag: member="GrUTLoader::LoadUbertex" ref="8e7dbf8a92517c281d2b0587a4bcdf55" args="(void *file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_gr_u_t_atlas.html">GrUTAtlas</a> * GrUTLoader::LoadUbertex           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>file</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
allocate some temporary space on the stack for the header.<p>
initialize an RLE decoder so that we can decode the atlas.<p>
initial read buffer size. First, we read in the header only. If we determine that the meta data and the atlas data can fit into the buffer, then we simply continue with our read.<p>
read in the ubertexture header.<p>
determine how big various tables and such are. Free the previous block of memory and allocate a larger block for the meta data and atlas data.<p>
first, verify the checksum.<p>
verify that the file magic is valid. The odds of this happening with the file checksum being valid is extremely small.<p>
verify the version is readable.<p>
use the header data to figure out how many chunks we need to read to get the rest of the header information, including the meta data and the tile-use atlas.<p>
allocate a buffer for the meta data and atlas data and copy the header data to it.<p>
read in rest of the meta data and atlas data.<p>
now decompress the atlas into the scratch memory buffer.<p>
free our read buffer.<p>
now build an atlas out of the atlas bitmap.<p>
free the scratch memory buffer.<p>
return the newly created atlas. 
<p>Definition at line <a class="el" href="_gr_u_t_loader_8cpp-source.html#l00305">305</a> of file <a class="el" href="_gr_u_t_loader_8cpp-source.html">GrUTLoader.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="9eca6963597c1c7e5c1f378774606f2f"></a><!-- doxytag: member="GrUTLoader::WriteChunk" ref="9eca6963597c1c7e5c1f378774606f2f" args="(void *file, unsigned int chunkIndex, const void *src)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GrUTLoader::WriteChunk           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>chunkIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>src</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
writes a tile to the ubertexture file. Note that the source data must be packed as follows: normal map X, Y diffuse B, G, R, A specular B, G, R, A 
<p>
calculate tile data starting addresses.<p>
wait for a free write slot.<p>
check to see if the current slot is ready. If so, stop spinning.<p>
advance to the next slot.<p>
each tile is 2048 bytes on disk. This means that there are a maximum of 8 * 2048 bits that can be written.<p>
compress the data.<p>
encode data into the write buffer.<p>
compress the data into the encoder.<p>
finish writing the data and calculate the total size of the data.<p>
increment chop in the case that we need to recompress the data at a higher compression ratio.<p>
write the data in the write buffer. 
<p>Definition at line <a class="el" href="_gr_u_t_loader_8cpp-source.html#l00434">434</a> of file <a class="el" href="_gr_u_t_loader_8cpp-source.html">GrUTLoader.cpp</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>C:/Bootstrap/ProjectBX/Documentation/Code/Engine/Graphics/<a class="el" href="_gr_u_t_loader_8h-source.html">GrUTLoader.h</a><li>C:/Bootstrap/ProjectBX/Documentation/Code/Engine/Graphics/<a class="el" href="_gr_u_t_loader_8cpp-source.html">GrUTLoader.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Feb 13 17:20:06 2009 for Bootstrap Engine by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
